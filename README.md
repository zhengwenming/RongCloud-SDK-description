# RongCloud-SDK-description

# æ¬¢è¿å…³æ³¨æˆ‘çš„æ–—é±¼ç›´æ’­é—´ï¼Œç”¨æ‰‹æœºæ–—é±¼TVï¼Œç›´æ¥æœç´¢`æ–‡æ˜ç›´æ’­é—´`æˆ–è€…`æç«¯ææƒ§`å°±å¯ä»¥æ‰¾åˆ°æˆ‘çš„ç›´æ’­ã€‚`iOSæŠ€æœ¯åˆ†äº«`ç›´æ’­ã€‚è¿›æ¥ç‚¹ä¸€ä¸‹å…³æ³¨ï¼Œè°¢è°¢ï¼Œå¼€æ’­ä¼šæœ‰æ¨é€åˆ°å¤§å®¶æ‰‹æœºã€‚ï¼ˆä¸ªäººç›´æ’­ï¼Œéæœºæ„ï¼Œé€‚åˆ`åˆçº§iOS`å’Œ`ä¸­çº§iOS`ï¼‰ã€‚

# æ¬¢è¿åŠ å…¥`iOSå¼€å‘æŠ€æœ¯æ”¯æŒç¾¤`ï¼Œ`479259423`ï¼Œè¿›ç¾¤å¿…é¡»æ”¹åï¼ˆ2å…ƒä»˜è´¹ç¾¤ï¼Œæ…å…¥ï¼ï¼‰ï¼Œç¾¤åç‰‡æ ¼å¼ï¼š`åŸå¸‚-iOS-åå­—`ï¼Œä¾‹å¦‚`å¹¿å·-iOS-æ–‡æ˜`ã€‚

ä¸‹é¢å‡ ç¯‡æ–‡ç« åˆ†åˆ«è¯¦ç»†çš„ä»‹ç»äº†èäº‘`SDK`å³æ—¶é€šè®¯æœºåˆ¶å’Œé›†æˆæ­¥éª¤ï¼Œç”±äºå›½å†…`CSDN`åšå®¢å°æ€å¸¦æœ‰å¹¿å‘Šæ€§è´¨çš„æ–‡ç« ï¼ˆå…¶å®ä¸æ˜¯æ‰“å¹¿å‘Šï¼Œçº¯ç²¹çš„æŠ€æœ¯åˆ†äº«ï¼‰ï¼Œæ‰€ä»¥åªèƒ½åœ¨`Github`å‘è¡¨äº†ã€‚å¸Œæœ›å¤§å®¶æ”¯æŒæˆ‘ï¼Œè°¢è°¢ã€‚

# èå…¥`Voip`åŠŸèƒ½çš„æç¤ºï¼š

ç°åœ¨çš„æ–°`SDK`ç”¨ä¸äº†`Voip`äº†ï¼Œå·²ç»åˆ†ç¦»å‡ºä¸€ä¸ª`CallKit`è¿›è¡Œæ”¶è´¹ã€‚å¦‚æœçœŸçš„è¦ç”¨`voip`ï¼Œæ™ºèƒ½ç”¨`2.5.2ç‰ˆæœ¬çš„sdk`ã€‚ä¸‹é¢æ˜¯å¼•ç”¨èäº‘å®˜æ–¹çš„æ–‡æ¡£åŸè¯

ç”±äºåº•å±‚å¼•æ“æŠ€æœ¯ä¸åŒï¼Œ`2.6.0` ä¹‹åçš„éŸ³è§†é¢‘ `SDK` ä¸ `2.6.0` ä¹‹å‰çš„ `SDK` ä¸­çš„ `VoIP` ä¸èƒ½äº’é€šã€‚
éŸ³è§†é¢‘ `SDK` ä¸ºå•†ç”¨æ”¶è´¹åŠŸèƒ½ï¼Œä¹‹å‰çš„ `SDK` ä¸­çš„ `VoIP` ä¸ºå…è´¹æµ‹è¯•åŠŸèƒ½ï¼Œå¦‚æœæ‚¨è¿˜æƒ³ä½¿ç”¨ä¹‹å‰çš„ `VoIP`ï¼Œå¯ä»¥ä½¿ç”¨ `2.5.2` ç‰ˆæœ¬ã€‚
 
 
# è¯´è¯´èäº‘å³æ—¶é€šè®¯`SDK`ç†è®ºç¯‡(ä¸€) 

>æ ‡ç­¾ï¼š `å³æ—¶é€šè®¯` `èŠå¤©` `èäº‘` `sdk` `iOS`

>åˆ†ç±»ï¼š`å³æ—¶é€šè®¯`

>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œæœªç»åšä¸»å…è®¸ä¸å¾—è½¬è½½ã€‚

  æœ¬äººç”¨è¿‡èäº‘çš„`1.4.4`å’Œ`2.2.4`ç‰ˆæœ¬çš„`SDK`ï¼Œåˆ†åˆ«ç”¨äºå¯¹ä¸¤æ¬¾`APP`çš„å³æ—¶é€šè®¯åŠŸèƒ½å¼€å‘é›†æˆï¼Œä¸»è¦ç”¨äº†`IMKit`ç±»ï¼ŒåŠŸèƒ½ä¸º`å•èŠ`ï¼ˆèŠå¤©å®¤å’Œç¾¤èŠä¸æ¶‰åŠï¼Œç†è§£äº†å•èŠï¼ŒèŠå¤©å®¤å’Œç¾¤èŠä¹Ÿå°±ä¸æ”»è€Œç ´ï¼‰,åæ§½ä¸€ä¸‹å…³äº`iOS`ç«¯èäº‘`SDK`é›†æˆèµ„æ–™å¾ˆå°‘ï¼Œåªèƒ½çœ‹èäº‘å®˜æ–¹çš„å¼€å‘æ–‡æ¡£ï¼Œç”±äºå¼€å‘æ–‡æ¡£çš„è¯­è¨€å’Œå…³é”®è¯ç”¨çš„ä¹Ÿæ¯”è¾ƒå®˜æ–¹æ¯”è¾ƒä¸“ä¸šåŒ–ï¼Œæˆ‘æƒ³è¦é€šä¿—æ˜“é€šï¼Œé›…ä¿—å…±èµçš„èµ„æ–™ï¼Œæ²¡æœ‰ï¼æ²¡æœ‰ï¼çœŸçš„æ²¡æœ‰ï¼åšå®¢ä¹‹ç±»çš„èµ„æ–™åªèƒ½æ‰¾åˆ°å®‰å“çš„æ–‡ç« ï¼Œæ— å¥ˆåªèƒ½`iOS`å°å±Œä¸çœ‹å®‰å“å¤§ç¥å†™çš„å…³äºèäº‘é›†æˆçš„androidä»£ç ï¼Œå°ä¼™ä¼´ä»¬çœ‹çš„æ˜¯å¾ˆè›‹ç–¼ã€‚ç°åœ¨ç¦åˆ©æ¥äº†ï¼Œ`iOS`ç«¯çš„èäº‘é›†æˆåšå®¢è¿™è¾¹çœ‹ï¼Œä¼šä¸æ–­æ›´æ–°ï¼ŒæŒç»­å…³æ³¨ã€‚æƒ³é›†æˆèäº‘èŠå¤©åŠŸèƒ½çš„å°ä¼™ä¼´ä¸é˜²å…ˆæ™®åŠä¸‹ç†è®ºçŸ¥è¯†ï¼Œé˜²æ­¢ä»¥åèµ°å¼¯è·¯åˆæˆ–è€…æ€»æ˜¯é—®äº›ä¸é è°±çš„é—®é¢˜ï¼Œ`æˆ‘ä¸ºä»€ä¹ˆä¸èƒ½èŠå¤©`ï¼Œ`ä¸ºä»€ä¹ˆå¤´åƒå’Œåå­—å‡ºä¸æ¥` ç­‰ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ–‡ç« ä¸­å¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹å¸Œæœ›å¤§å®¶æå‡ºï¼Œæœ¬äººä¼šåŠæ—¶æ”¹æ­£ï¼Œé¿å…è¯¯äººå­å¼Ÿï¼Œé«˜æ‰‹å‹¿å–·ï¼Œå“ˆå“ˆã€‚ã€‚ã€‚

  èäº‘çš„`SDK`å¯ä»¥è§£å†³å¾ˆå¤š`app`ä¸­å³æ—¶é€šè®¯çš„åŠŸèƒ½ï¼Œæ— è®ºæ˜¯å®‰å“è¿˜æ˜¯`iOS`ï¼ˆ`web`ä¹Ÿå¯ä»¥ï¼Œå¼ºå¤§æ— æ¯”ï¼‰ï¼Œéƒ½å¯ä»¥è€ƒè™‘ç”¨ç¬¬ä¸‰æ–¹å»å®ç°èŠå¤©çš„åŠŸèƒ½ï¼Œè€Œä¸”ç°åœ¨`app`ä¸­é›†æˆèŠå¤©çš„åŠŸèƒ½å¾ˆç«å¾ˆæ—¶é«¦ï¼Œä¸æ˜¯å—ï¼Ÿæ”¶åºŸå“ã€æ—§å®¶ç”µçš„è€æ¿éƒ½æ¨ä¸å¾—ä¸ºè‡ªå·±çš„`APP`åŠ ä¸Šå³æ—¶é€šè®¯ç¿…è†€ï¼Œè®©è‡ªå·±çš„`app`é£èµ·æ¥ã€‚åºŸè¯å°‘è¯´ï¼Œå…ˆæ¥ç†è§£ä¸‹èäº‘çš„å³æ—¶é€šè®¯æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯ç†è®ºéƒ¨åˆ†ã€‚

   èäº‘ä¸ç»´æŠ¤å¥½å‹å…³ç³»ï¼Œåªè´Ÿè´£è½¬å‘æ¶ˆæ¯ã€‚ä¸ç»´æŠ¤å¥½å‹å…³ç³»æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ç”¨èäº‘çš„`SDK`é›†æˆèŠå¤©ï¼Œå¥½å‹ä¹‹é—´éƒ½å¯ä»¥è¿›è¡ŒèŠå¤©å•Šï¼Œæ€ä¹ˆä¼šä¸ç»´æŠ¤å¥½å‹å…³ç³»å‘¢ï¼ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬æ¥ç†è§£ä¸‹ï¼š `ä¸ç»´æŠ¤å¥½å‹å…³ç³»ï¼Œåªè´Ÿè´£è½¬å‘æ¶ˆæ¯` çš„æ„æ€æ˜¯èäº‘çš„æœåŠ¡å™¨ç»™æˆ‘ä»¬è½¬å‘æ¶ˆæ¯ï¼Œèäº‘çš„`SDK`å®Œæˆå‘é€æ¶ˆæ¯çš„åŠŸèƒ½ï¼ˆ`SDK`ä¸­çš„æ–¹æ³•å®ç°ï¼Œ`webåå°`ä¹Ÿå¯ä»¥è°ƒç”¨èäº‘æä¾›çš„æ¥å£å‘é€æ¶ˆæ¯ï¼‰ï¼Œæ¶ˆæ¯ä»ä¸€ä¸ªäºº`fromUserId`ï¼ˆæ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªidï¼Œåé¢ä¼šè¯¦ç»†è®²åˆ°ï¼‰è½¬å‘åˆ°å¦ä¸€ä¸ªäºº`toUserId`é‚£é‡Œï¼Œé‚£ä¹ˆæ¯ä¸ªç”¨æˆ·çš„å¥½å‹å…³ç³»å’Œç¾¤ç»„å…³ç³»æ˜¯è¦ä¿å­˜åœ¨è‡ªå·±å…¬å¸çš„æœåŠ¡å™¨çš„ï¼Œè¿™ç‚¹å°±è§£é‡Šäº†ä¸Šé¢çš„è¯ï¼Œèäº‘æä¾›ä¸€ä¸ªè½¬å‘æ¶ˆæ¯çš„å¹³å°ï¼ˆæœåŠ¡å™¨å’ŒSDKä»¥åŠæ¥å£ç­‰ï¼‰ï¼Œå› ä¸ºè¦æ»¡è¶³å¹¿å¤§å¼€å‘è€…çš„éœ€æ±‚ï¼Œæ‰€ä»¥ä¸å¯èƒ½ä¸ºæ²¡ä¸ªå¼€å‘è€…éƒ½ç»´æŠ¤è¿™ä¸ªå¥½å‹å…³ç³»å’Œç¾¤ç»„å…³ç³»ã€‚ä¸¾ä¸ªæ —å­ï¼Œ`ç”¨æˆ·A`æœ‰100ä¸ªå¥½å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªèäº‘æ˜¯ä¸çŸ¥é“çš„ï¼Œä¹Ÿä¸ä¼šå…³å¿ƒ`ç”¨æˆ·A`çš„å¥½å‹å…³ç³»ï¼Œè°çŸ¥é“å‘¢ï¼Ÿæˆ‘ä»¬å¼€å‘è€…è‡ªå·±çš„åå°è¦çŸ¥é“ï¼Œæˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨è¦ç»´æŠ¤å¥½å‹å…³ç³»å’Œç¾¤ç»„å…³ç³»ï¼Œå…·ä½“åšæ³•å°±æ˜¯è¦ç”¨æ¥å£å»å»ºç«‹å¥½å‹å…³ç³»ï¼Œç„¶åå†ç”¨å¦å¤–çš„ä¸€ä¸ªæ¥å£å»ä¿å­˜`ç”¨æˆ·A`çš„æ‰€æœ‰å¥½å‹ã€‚è¿™æ ·çš„è¯ï¼Œ`ç”¨æˆ·A`ç™»å½•ä¹‹åå°±å¯ä»¥è°ƒç”¨å¥½å‹åˆ—è¡¨çš„æ¥å£æ‹¿åˆ°è‡ªå·±çš„æ‰€æœ‰å¥½å‹ï¼Œç„¶åå°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº†ï¼Œå…¶å®ä¹Ÿå°±æ˜¯å’Œè‡ªå·±çš„å¥½å‹å‘é€æ¶ˆæ¯äº†ï¼Œå‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œä¸æ˜¯èµ°è‡ªå·±å…¬å¸çš„æœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼Œæ³¨æ„ï¼Œè¿™é‡Œå‘é€æ¶ˆæ¯æ˜¯èµ°èäº‘çš„æœåŠ¡å™¨ï¼Œæ€ä¹ˆä¼šèµ°èäº‘çš„æœåŠ¡å™¨å‘¢ï¼Ÿå¥‡æ€ªï¼Œèäº‘æ€ä¹ˆçŸ¥é“æˆ‘ç™»å½•äº†å‘¢ï¼Ÿåˆ«æ€¥ï¼Œä¸‹é¢ä¼šè®²åˆ°`token`ï¼Œä»¥åŠ`connect`è¿æ¥èäº‘æœåŠ¡å™¨ã€‚æ¶ˆæ¯çš„æµå‘æ˜¯è¿™æ ·çš„ï¼Œä»è‡ªå·±è¿™é‡Œ`fromUserId`ï¼ˆè‡ªå·±çš„`id`ï¼‰èµ°åˆ°èäº‘çš„æœåŠ¡å™¨ï¼Œç„¶åèäº‘æœåŠ¡å™¨è½¬å‘åˆ°å¥½å‹`toUserId`é‚£é‡Œï¼Œå› ä¸ºæ¶ˆæ¯ä½“ä¸­å«æœ‰å¾ˆå¤šçš„å±æ€§ï¼Œæ¶ˆæ¯ä½“æœ¬èº«å¯ä»¥é™„å¸¦ä¿¡æ¯ï¼Œæ¯”å¦‚`targetId`ï¼ˆå°±æ˜¯`toUserId`ï¼Œè¿™é‡Œä¸¤è€…ä¸€æ ·ï¼‰ï¼Œ`extra`é™„åŠ ä¿¡æ¯ï¼Œç”¨äºæä¾›ç»™å¼€å‘è€…æ‹“å±•åŠŸèƒ½ï¼Œä½ æƒ³è®©æ¶ˆæ¯å¸¦ä»€ä¹ˆä¿¡æ¯éƒ½å¯ä»¥å¸¦ï¼Œä½†æ˜¯å¤§å°æœ‰é™åˆ¶ï¼Œä¸€èˆ¬å¸¦`å­—ç¬¦ä¸²`æˆ–`json`æ•°æ®ï¼Œæˆ‘ç”¨è¿™ä¸ªå­—æ®µè§£å†³äº†å¥½å‹å¤´åƒçš„åŠæ—¶æ›´æ–°åŠŸèƒ½ï¼Œè¿™ä¸ªå­—æ®µçš„ç”¨æ³•æ”¾å¼€å‘ç¯‡ç« ä¸­ç»†ç»†è®²è§£ã€‚

   ç°åœ¨è¯´è¯´`userId`ï¼Œç”¨æˆ·çš„ `èº«ä»½è¯å·ç ` ã€‚æ¯ä¸ª`APP`çš„æ³¨å†Œç”¨æˆ·éƒ½ä¼šè¢«åˆ†é…ä¸€ä¸ª`userId`ï¼Œå°±æ˜¯ç”¨æ¥åŒºåˆ†ç”¨æˆ·çš„ï¼Œå°±å¥½åƒæˆ‘ä»¬çš„èº«ä»½è¯å·ç ä¸€æ ·ï¼Œä¸ä¼šé‡å¤ï¼Œå…·æœ‰å”¯ä¸€æ€§ã€‚é‚£ä¹ˆå†è¯´è¯´è°å»åˆ†é…`ç”¨æˆ·A`çš„`userId`å‘¢ï¼Ÿèäº‘ä¼šåˆ†é…å—ï¼Ÿç­”æ¡ˆæ˜¯`NO`ã€‚è¿˜æ˜¯é‚£å¥è¯èäº‘åªè´Ÿè´£è½¬å‘æ¶ˆæ¯ï¼Œåˆ†é…`userId`è¿™ä¸ªä»»åŠ¡è¿˜æ˜¯è¦æˆ‘ä»¬åå°è‡ªå·±æ¥æï¼Œå½“`ç”¨æˆ·A`æ³¨å†Œçš„æ—¶å€™ï¼Œåå°åˆ†é…ç»™`A`ä¸€ä¸ª`userId`å¹¶ä¸”è¿”å›ç»™å‰ç«¯å¼€å‘äººå‘˜ä½¿ç”¨ï¼Œå‰ç«¯å¼€å‘äººå‘˜æ‹¿åˆ°`A`çš„`userId`ä¹‹åï¼Œå°±è¦ç”¨è¿™ä¸ªAç”¨æˆ·çš„å”¯ä¸€çš„`userId`å»ç™»å½•èäº‘çš„æœåŠ¡å™¨ï¼Œå½“ç„¶ä¸æ˜¯ä»»ä½•äººæœ‰ä¸ªuserIdéƒ½å¯ä»¥éšä¾¿è¿æ¥èäº‘çš„æœåŠ¡å™¨çš„å“¦ï¼Œå¤§å®¶éƒ½çŸ¥é“ä»»ä½•ç¬¬ä¸‰æ–¹å…¬å¸éƒ½æ²¡æœ‰é‚£ä¹ˆéšä¾¿ï¼Œä¸å®‰å…¨ï¼Œä¼šè¢«æ”»å‡»ï¼Œæ˜¯è¦`Token`éªŒè¯çš„ã€‚æœ‰è¿™ä¸ª`Token`å°±è®©ä½ è¿æ¥ï¼Œæ²¡æœ‰`token`çš„è¯ï¼Œæ»šè›‹ã€‚é‚£ä¹ˆæˆ‘ä»¬å†™`demo`ï¼Œæµ‹è¯•çš„è¯æ€ä¹ˆåŠï¼Œ`token`æ€ä¹ˆè·å–ï¼Ÿå»èäº‘å¼ºå¤§çš„åå°è°ƒè¯•ç³»ç»Ÿé‡Œé¢å»æ‹¿tokenæµ‹è¯•ï¼Œç™»å½•èäº‘çš„å®˜ç½‘ä¹‹åç‚¹å‡»ä½ åˆ›å»ºçš„åº”ç”¨ï¼Œç„¶åæ‰¾åˆ°IMæœåŠ¡ä¸­çš„APIè°ƒè¯•ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯è·å–`token`ã€‚æ•´ä¸ªç™»å½•çš„æµç¨‹æ˜¯è¿™æ ·æ»´ï¼Œå¼€å‘è€…å»èäº‘å®˜ç½‘æ³¨å†Œä¸ªè´¦å·---->`ç™»å½•èäº‘å®˜ç½‘`---->`åˆ›å»ºä¸€ä¸ªåº”ç”¨`---->`æ‹¿åˆ°èäº‘åˆ†é…ç»™æ­¤åº”ç”¨çš„appkey`---->`appä¸­ä»£ç å…ˆæ³¨å†Œèäº‘çš„appKey`---->`è·å–tokenè·å–token`---->`æ‹¿tokenå»connectèäº‘æœåŠ¡å™¨`ã€‚å¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œä½†æ˜¯å¼€å‘è¿‡ç¨‹ä¸­è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

 ï¼ˆä¸€ï¼‰`appkey`åŒ…æ‹¬æ­£å¼ä¸Šçº¿çš„ `appkey` å’Œå¼€å‘ç¯å¢ƒçš„ `appkey`ã€‚ç°åœ¨çš„æ–° SDK å–æ¶ˆç”¨ `appSecret`ï¼Œæˆ‘ä»¬ä»£ç ä¸­ç”¨çš„æ˜¯`appkey`ï¼Œä¸æ˜¯`appSecret`ï¼Œæ‰€ä»¥æš‚æ—¶ä¸è¦ç®¡`appSecret`ï¼Œä½†æ˜¯ä¸è¦éšä¾¿åˆ·æ–°è¿™ä¸ªç§˜é’¥ï¼Œåæœè‡ªè´Ÿã€‚

 ï¼ˆäºŒï¼‰`token`æ€ä¹ˆè·å–ï¼Œå“ªé‡Œå»è·å–ï¼Ÿ`token`çš„è·å–æ˜¯è¦è‡ªå·±å…¬å¸çš„åå°æä¾›ä¸€ä¸ªè·å–èäº‘`token`çš„ä¸“é—¨æ¥å£ï¼Œè‡ªå·±çš„åå°å¼€å‘äººå‘˜å»çœ‹æ–‡æ¡£åšæ¥å£ï¼Œåå°ç›¸å…³äº‹æƒ…è¿™é‡Œä¸åšè§£ç­”ï¼ˆä¸€å¥è¯ï¼šå»çœ‹èäº‘å¼€å‘æ–‡æ¡£ï¼‰ã€‚è·å–åˆ°`token`åï¼Œå°±å¯ä»¥æ‹¿ä¸€ä¸ª`ç”¨æˆ·A`çš„`userId`å»è¿æ¥èäº‘çš„æœåŠ¡å™¨äº†ï¼Œèäº‘çš„æ–¹æ³•å«`connectWithToken` `connect` æˆåŠŸäº†ä¹‹åä¼šè¿”å›ç™»å½•äººçš„`userId`ï¼Œå¤±è´¥äº†ä¼šè¿”å›`error`çš„æè¿°ï¼ˆä¸€ä¸ªæšä¸¾ï¼Œè¯¦ç»†çš„è§£é‡Š`connect`å¤±è´¥çš„åŸå› ï¼‰ã€‚å…·ä½“çœ‹ä¸‹é¢ä»£ç ï¼Œæ³¨æ„ï¼Œæˆ‘çš„åšæ³•æ˜¯æ¯æ¬¡éƒ½è·å–`token`ï¼Œè¿˜æœ‰å…¶ä»–çš„å¤„ç†`token`æ–¹å¼ï¼Œå…·ä½“çš„çœ‹èäº‘å¼€å‘æŒ‡å—ï¼Œæˆ‘è¿™é‡Œæä¾›ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚
 ï¼ˆä¸‰ï¼‰é›†æˆçš„æ­¥éª¤ä¸è¦é”™äº†ï¼Œä¸€å®šè¦æŒ‰ç…§é¡ºåºã€‚æˆ‘ä¸¾ä¸ªæ —å­:æœ‰äº›å¼€å‘è€…æŠŠé¡¹ç›®ç”¨`StoryBoard`æ­å»ºèµ·æ¥ä¹‹åï¼Œå°±é©¬ä¸Šæƒ³ç”¨èŠå¤©åˆ—è¡¨ï¼Œæƒ³çœ‹åˆ°èŠå¤©åˆ—è¡¨ï¼Œæƒ³çœ‹çœ‹èŠå¤©ç•Œé¢ï¼Œè¿™æ ·æœ‰æ—¶å€™ä¼šå´©æºƒï¼Œå°±è·‘æ¥é—®æˆ‘ï¼Œæ€ä¹ˆå›äº‹ï¼Ÿæˆ‘ä¹Ÿå¾ˆéš¾å›ç­”ä½ æ˜¯æ€ä¹ˆä¸€å›äº‹ã€‚æ‰€ä»¥å¤§å®¶å…ˆæŠŠé¡¹ç›®å»ºç«‹èµ·æ¥ï¼Œç„¶åæŒ‰ç…§æ­¥éª¤ï¼Œä¸€æ­¥ä¸€æ­¥çš„æ¥ï¼Œä½ éƒ½æ²¡æ³¨å†Œ`appkey`ï¼Œä¹Ÿæ²¡æœ‰æ‹¿`token`ï¼Œä¹Ÿæ²¡æœ‰`connect`ã€‚é‚£ä¹ˆè¿™æ ·çš„å´©æºƒè®©èäº‘çš„æŠ€æœ¯æˆ–è€…æ˜¯æˆ‘å»è§£å†³è¿™æ ·çš„`bug`ï¼Œå…¶å®æˆ‘ä»¬çš„å†…å¿ƒä¹Ÿæ˜¯å´©æºƒçš„ã€‚

è¿™å¥ä»£ç æ˜¯æ³¨å†Œ`appkey`çš„ï¼Œå…ˆçœ‹çœ‹ï¼Œåˆ°å¼€å‘ç¯‡é‡Œé¢è¿˜ä¼šæœ‰ `[[RCIM sharedRCIM] initWithAppKey:@"YourTestAppKey"];`
ä¸‹é¢çš„`blok`æ˜¯ç”¨`token`å»é“¾æ¥èäº‘æœåŠ¡å™¨ã€‚å¼€å‘ç¯‡è¿˜ä¼šå†æä¾›ï¼Œå…ˆåˆæ­¥äº†è§£ä¸‹ã€‚
```Object-C
 [[RCIMsharedRCIM]connectWithToken:YourToken success:^(NSString *userId) {

                    [RCIMsharedRCIM].globalNavigationBarTintColor = [UIColorwhiteColor];

                    NSLog(@"login success with userId %@",userId);

                    [UserInfoModel loginUserinfo:model];

                    //åŒæ­¥å¥½å‹åˆ—è¡¨

                    [self syncFriendList:^(NSMutableArray *friends,BOOL isSuccess) {

                        NSLog(@"%@",friends);

                        if (isSuccess) {

                            NSLog(@" successå‘é€é€šçŸ¥");

                            [[NSNotificationCenterdefaultCenter]postNotificationName:@"alreadyLogin" object:nil];//å‘é€è‡ªå®šä¹‰é€šçŸ¥ï¼ˆä¸æ˜¯èäº‘çš„ï¼‰ï¼Œå¤„ç†ä¸€äº›é€»è¾‘ï¼Œæ¯”å¦‚ä»€ä¹ˆå„å•ä½æ³¨æ„ï¼Œæˆ‘å·²ç™»å½•ï¼Œæˆ‘å·²ç™»å½•ã€‚

                        }

                    }];

                    [RCIMClient sharedRCIMClient].currentUserInfo = [[RCUserInfoalloc]initWithUserId:userinfo.userIdname:userinfo.userNameportrait:userinfo.photophone:userinfo.phoneaddressInfo:userinfo.companyrealName:userinfo.realName];

                   

                } error:^(RCConnectErrorCode status) {

                    NSLog(@"status = %ld",(long)status);

                } tokenIncorrect:^{

                    self.success =NO;

                    [MSUtil showTipsWithHUD:@"tokenIncorrect"];

                }];

```

>è¿æ¥æˆåŠŸäº†ï¼Œç»§ç»­çœ‹ã€‚è¦æƒ³å’Œå¥½å‹èŠå¤©ï¼Œæˆ‘ä»¬è¿˜è¦æœ‰å¥½å‹ï¼Œæœ‰äº†å¥½å‹æ‰èƒ½æ­£å¸¸èŠå¤©ï¼Œæˆ‘çš„å¥½å‹æ˜¯ä¿å­˜åœ¨ä¸€ä¸ªå…¨å±€çš„æ•°ç»„é‡Œé¢çš„ï¼Œappå¯åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ç½‘ç»œè¯·æ±‚è‡ªå·±çš„åå°ï¼Œæ‹¿åˆ°æˆ‘ä»¬åå°ç»´æŠ¤çš„å¥½å‹æ•°ç»„ï¼Œç„¶åæ”¾æ•°ç»„é‡Œé¢ï¼Œè¿™æ ·æˆ‘å…¨å±€å¯ä»¥æ‹¿åˆ°ã€‚å¦å¤–ï¼Œè¿˜è¦å®ç°ä¸€ä¸ªä»£ç†æ–¹æ³•ï¼Œè¿™ä¸ªä»£ç†å«åš`RCIMUserInfoDataSource`ï¼ˆ`2.2.4ç‰ˆæœ¬`çš„å«`RCIMUserInfoDataSource`ï¼Œä»¥å‰çš„è€ç‰ˆæœ¬æ¯”è¾ƒéº»çƒ¦äº›ï¼Œè¦å®ç°ä¸¤ä¸ªä»£ç†`RCIMFriendsFetcherDelegate,RCIMUserInfoFetcherDelegagte`ï¼‰è¿™ä¸ªä»£ç†æ–¹æ³•æ˜¯æä¾›å¥½å‹ä¿¡æ¯çš„ï¼Œç»™è°æä¾›å¥½å‹ä¿¡æ¯ï¼Ÿä½ å’Œä½ çš„å¥½å‹èŠå¤©ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨èµ°ä»£ç†æ–¹æ³•ï¼Œå»æ‹¿å¥½å‹ä¿¡æ¯ï¼Œæ‰€ä»¥é‚£äº›è¯´â€œæˆ‘çš„å¥½å‹å¤´åƒå’Œåå­—æ€ä¹ˆå‡ºä¸æ¥â€çš„åŒå­¦è¦æ³¨æ„äº†ï¼Œéµå®ˆä»£ç†äº†å—ï¼Ÿæ˜¯ä¸æ˜¯ä½ çš„ä»£ç†æ²¡è®¾ç½®ï¼Œæ˜¯ä¸æ˜¯æ²¡å®ç°ä»£ç†æ–¹æ³•ï¼Œæ–¹æ³•é‡Œé¢æœ‰æ²¡æœ‰é—®é¢˜ï¼Œæœ‰æ²¡æœ‰é…ç½®å¥½ä½ çš„å¥½å‹ä¿¡æ¯ï¼Ÿä¸ç„¶å¥½å‹å¤´åƒå’Œåå­—æ€ä¹ˆä¼šå‡ºä¸æ¥å‘¢ï¼é™„ä¸Šä»£ç†æ–¹æ³•åå­—å’Œå®ç°

```Object-C
- (void)getUserInfoWithUserId:(NSString*)userId completion:(void (^)(RCUserInfo*))completion

{

    NSLog(@"getUserInfoWithUserId ----- %@", userId);

    

    if (userId == nil || [userId length] == 0 )

    {

        completion(nil);

        return ;

    }

   

    if ([userIdisEqualToString:[RCIMsharedRCIM].currentUserInfo.userId]) {//è‡ªå·±

        UserInfoModel *myselfInfo = [UserInfoModelcurrentUserinfo];

        RCUserInfo *aUser = [[RCUserInfoalloc]initWithUserId:myselfInfo.userIdname:myselfInfo.realNameportrait:myselfInfo.photophone:myselfInfo.phoneaddressInfo:myselfInfo.companyrealName:myselfInfo.realName];

        completion(aUser);

    }

    

    for (NSInteger i =0; i<[AppDelegateshareAppDelegate].friendsArray.count; i++) {//å¾ªç¯å…¨å±€çš„å¥½å‹æ•°ç»„ï¼Œæ‹¿åˆ°userIdç›¸åŒçš„ï¼Œæ¯”å¦‚ï¼ŒuserIdï¼ 12çš„æ˜¯è€ç‹ï¼Œé‚£ä¹ˆå¾ªç¯ï¼Œæ‰¾åˆ°æ•°ç»„ä¸­userIdï¼12çš„ï¼Œé‚£ä¹ˆè‚¯å®šå°±æ˜¯è€ç‹å•¦ã€‚é‚£ä¹ˆè‚¯å®šå°±é…ç½®å¥½è€ç‹çš„ä¿¡æ¯äº†ï¼Œå’Œè€ç‹èŠå¤©çš„æ—¶å€™ï¼Œèäº‘å†…éƒ¨å°è£…çš„æ–¹æ³•å°±å¯ä»¥æ‹¿åˆ°è€ç‹çš„ä¿¡æ¯ï¼Œè¿™æ ·è€ç‹çš„å¤´åƒå’Œåå­—å°±å¯ä»¥å‡ºæ¥äº†

        RCUserInfo *aUser = [AppDelegateshareAppDelegate].friendsArray[i];

        if ([userId isEqualToString:aUser.userId]) {

            completion(aUser);

        }

    }

}
```



æœ€åå¼€å§‹å‘æ¶ˆæ¯ç»™å¥½å‹ï¼Œæ¯”å¦‚ç‚¹å‡»ä¸€ä¸ª`cell`ï¼ˆæˆ–è€…ä¸€ä¸ªé¡µé¢çš„`Button`ï¼‰ï¼Œæ‹¿åˆ°è¿™ä¸ª`cell`å¯¹åº”äººçš„`userId`ï¼Œæ‹¿åˆ°å¯¹æ–¹çš„`userId`åï¼Œå°±å¯ä»¥å»ºç«‹ä¸€ä¸ªä¼šè¯äº†ï¼Œé‚£ä¹ˆå¼€å§‹ä¸Šä»£ç 
```Object-C
ConversationViewController *_conversationVC = [[ConversationViewControlleralloc]init];

_conversationVC.conversationType = ConversationType_PRIVATE;//å•èŠï¼ˆä¹Ÿå«ç§èŠï¼‰ï¼Œä¼šè¯ç±»å‹

_conversationVC.targetId = [NSStringstringWithFormat:@"%@",model.data[@"id"]];//æ¶ˆæ¯çš„ç›®æ ‡idï¼Œå¯¹æ–¹çš„userIdï¼Œå°±æ˜¯ä¸Šæ–‡è¯´çš„toUserId

_conversationVC.userName = [NSStringstringWithFormat:@"%@",model.data[@"agentTeamName"]];//ä¼šè¯å¯¹æ–¹çš„äººåå­—

_conversationVC.title = [NSStringstringWithFormat:@"%@",model.data[@"realName"]];//ä¼šè¯å¯¼èˆªä¸Šçš„title

[self.navigationControllerpushViewController:_conversationVCanimated:YES];
```


`ConversationViewController`æ˜¯å¼€å‘è€…è‡ªå·±å»ºç«‹çš„`VC`ï¼Œç»§æ‰¿èäº‘çš„`RCConversationViewController`ç±»ï¼Œç»§æ‰¿ä¹‹åï¼Œå­ç±»å°±å¯ä»¥ç”¨é‡å†™çˆ¶ç±»çš„æ–¹æ³•äº†ï¼Œæƒ³ç”¨ä»€ä¹ˆå°±ç‚¹è¿›å»æ‰¾ä»€ä¹ˆæ–¹æ³•ï¼Œå¦‚æœä½ ä¹Ÿä¸çŸ¥é“ä½ éœ€è¦ä»€ä¹ˆæ–¹æ³•ï¼Œé‚£ä¹ˆå°±è·Ÿç€æˆ‘çš„æ–‡ç« èµ°ï¼Œæˆ‘å°†ä¼šä»‹ç»å¤§éƒ¨åˆ†èäº‘APIçš„ä½¿ç”¨åœºæ™¯ã€‚

å¥½äº†ï¼Œç°åœ¨å¯ä»¥å‘é€æ¶ˆæ¯äº†ï¼Œå› ä¸º`RCConversationViewController`ç±»å·²ç»å®ç°äº†`UI`å’Œ`åŠŸèƒ½`ã€‚



ç†è®ºç¯‡åˆ°æ­¤ç»“æŸã€‚ä¸‹é¢ä¼šæœ‰å¼€å‘ç¯‡ï¼Œè°¢è°¢ã€‚æœ‰é—®é¢˜åœ¨æˆ‘çš„å¼€å‘ç¾¤é‡Œæé—®ï¼Œç¾¤å·`487599875`.


>ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼


 è¯´è¯´èäº‘å³æ—¶é€šè®¯`SDK`å¼€å‘ç¯‡(äºŒ) 



ç†è®ºçŸ¥è¯†ç†è§£ä¹‹åï¼Œå°±å¯ä»¥å¿«é€Ÿé›†æˆäº†ã€‚æœ‰å¤šå¿«ï¼Ÿå¸¸å¸¸æœ‰å¼€å‘è€…é—®ï¼Œä¸€å¤©å¯ä»¥é›†æˆèäº‘çš„èŠå¤©åŠŸèƒ½å—ï¼Ÿæˆ‘æƒ³è¯´æˆ‘ç°åœ¨ä¸€å¤©éƒ½æä¸å®šï¼Œä½ ä¸ç”¨å¤„ç†é€»è¾‘çš„å—ï¼Ÿä½ ä»…ä»…æ˜¯å†™ä¸ª`demo`è¿˜æ˜¯åšé¡¹ç›®å•Šï¼Ÿå¦‚æœæ˜¯å†™ä¸ª`demo`ï¼Œæˆ‘`1ä¸ªå°æ—¶`å¯ä»¥é›†æˆ`èŠå¤©åŠŸèƒ½`äº†ã€‚æ‰€ä»¥å¤§å®¶è¿˜æ˜¯è¦æŒ‰éƒ¨å°±ç­çš„æ¥ï¼Œæ¬²é€Ÿæµ‹ä¸è¾¾ã€‚

### å¥½äº†ï¼Œä¸æ‰¯æ·¡äº†ï¼Œå¼€å§‹é›†æˆã€‚

>ä¸€ã€å»[èäº‘å®˜ç½‘](http://www.rongcloud.cn)ä¸‹è½½`SDK`ã€‚è¡¥å……ä¸€å¥æœ€å¥½ç”¨å®˜ç½‘æœ€æ–°çš„`SDK`ï¼Œåƒä¸‡ä¸è¦å€’é€€å•Šï¼Œæœ€æ–°çš„`SDK`æ¯”è¾ƒå®Œå–„ï¼ŒæŠŠä»¥å‰æ—§ç‰ˆæœ¬çš„`SDK`çš„`bug`éƒ½ä¿®å¤äº†ï¼Œå½“ç„¶è‚¯å®šè¿˜æœ‰`bug`å­˜åœ¨ï¼Œä½†æ˜¯å·²ç»æ¯”è¾ƒå°‘äº†ï¼Œè€Œä¸”ä½ ä¹Ÿä¸ä¸€å®šå°±è¸©åˆ°é›·äº†ï¼Œå¦‚æœè¸©åˆ°äº†ï¼Œå»ç»™èäº‘å‘å·¥å•ï¼Œæ¯ä¸ªå·¥å•éƒ½ä¼šå¾—åˆ°å›ç­”ï¼Œå¤§éƒ¨åˆ†ä¼šä»¤ä½ æ»¡æ„çš„ï¼Œä¸æ»¡æ„ä¹Ÿæ²¡åŠæ³•ã€‚å¥½äº†ï¼Œä¸‹è½½å®Œä¹‹åæ‰¾åˆ°`SDK`çš„æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€ï¼Œç„¶åè‡ªå·±åœ¨è‡ªå·±å·¥ç¨‹ä¸­å»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹æ¯”å¦‚æˆ‘çš„å°±æ˜¯`RongCloud_SDK_2_2_4`ï¼Œè¿™æ ·æ¸…æ™°æ˜äº†çš„çœ‹åˆ°äº†ä½œç”¨å’Œç‰ˆæœ¬å·ï¼Œå†ç„¶åå°±æ˜¯æ‹–SDKè¿›æ¥å·¥ç¨‹ä¸­çš„æ–‡ä»¶å¤¹`RongCloud_SDK_2_2_4`ï¼Œé™¤å»`release_notes_ios.txt`ä¸ç”¨æ‹–è¿›æ¥ï¼Œå…¶ä»–çš„éƒ½æ‹–è¿›æ¥ï¼Œä¸ç„¶ä½ å°±æ‹–äº†ä¸¤ä¸ª`frameWork`ï¼Œåé¢å¼€å‘ä¸­è‚¯å®šä½ ä¼šå«ï¼Œä¸ºä»€ä¹ˆæˆ‘çš„è¡¨æƒ…ğŸ˜Šå‡ºä¸æ¥ï¼Œä¸ºä»€ä¹ˆæˆ‘çš„æ˜¯è‹±æ–‡çš„ï¼Œå„ç§å¥‡è‘©`bug`å‡ºç°äº†ï¼ŒåŸå› å°±åœ¨æ­¤ï¼Œä½ è¦æŠŠ`emoji`çš„`plist`æ–‡ä»¶å’Œè¯­è¨€å›½é™…åŒ–çš„ä¸œä¸œä¹Ÿä¸€èµ·æ‹‰è¿›å·¥ç¨‹ã€‚è®°å¾—ç‚¹å‡»`copy`é€‰é¡¹ã€‚

>äºŒã€æ·»åŠ frameWorkï¼Œè€Œä¸”è¦å…¨é¢ã€‚åœ¨ç¬¬ä¸€æ­¥çš„åŸºç¡€ä¸Šæ·»åŠ èäº‘SDKçš„ä¾èµ–åº“ï¼Œéƒ½æ˜¯ç³»ç»Ÿçš„ï¼Œå®˜ç½‘æœ‰åº“åˆ—è¡¨ï¼Œæ…¢æ…¢åŠ ã€‚

`AssetsLibrary.framework`

`AudioToolbox.framework`

`AVFoundation.framework`

`CFNetwork.framework`

`CoreAudio.framework`

`CoreGraphics.framework`

`CoreLocation.framework`

`CoreMedia.framework`

`CoreTelephony.framework`

`CoreVideo.framework`

`ImageIO.framework`

`libc++.tbd`

`libc++abi.tbd`

`libsqlite3.tbd`

`libstdc++.tbd`

`libxml2.tbd`

`libz.tbd`

`MapKit.framework`

`OpenGLES.framework`

`QuartzCore.framework`

`SystemConfiguration.framework`

`UIKit.framework`

>ä¸‰ã€åˆ°å·¥ç¨‹çš„è®¾ç½®é€‰æ‹©ä¸­ï¼Œç³»ç»Ÿsettingï¼Œæœç´¢åˆ°Other linker Flags åŒå‡»è¿™ä¸€è¡Œï¼Œå¡«å†™-ObjC,ä¸»æ„Oå’ŒCæ˜¯å¤§å†™çš„ï¼Œå¤§å°å†™æ•æ„Ÿã€‚ï¼ˆä¸åŠ è¿™ä¸ªflagå¥½åƒå‘æ¶ˆæ¯ä¼šå´©æºƒï¼‰

>å››ã€å¯¼å…¥å¤´æ–‡ä»¶

`#import <RongIMKit/RongIMKit.h>`
`import <RongIMKit/RongIMKit.h>`

  è¿™ä¸ªä¸€èˆ¬åº”è¯¥æ˜¯åœ¨`appdelegate`é‡Œé¢å€’å…¥ï¼Œå› ä¸ºç¨‹åºå…¥å£ï¼Œæˆ‘ä»¬è¦åˆå§‹åŒ–èäº‘çš„appkeyï¼ˆç†è®ºç¯‡æœ‰è¯¦ç»†ä»‹ç»ï¼Œå¼€å‘ç¯‡ä¸å†èµ˜è¿°ï¼‰ã€‚
åœ¨è¿™ä¸ªæ–¹æ³•ä¸­åˆå§‹åŒ–
`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`  æœ€å¥½å†™ä¸€ä¸ªæ–¹æ³•ä¸“é—¨æ”¾ç½®èäº‘çš„é€»è¾‘ï¼Œ`initRongCloud`æ–¹æ³•æ”¾ç½®èäº‘çš„åˆå§‹åŒ–
```Object-C
- (void)initRongCloud{

   // è¿™ä¸ªå¥½å‹æ•°ç»„friendArrayï¼Œæˆ‘æ”¾åˆ°appdelegateçš„.hä¸­å£°åï¼Œç¨‹åºä»»ä½•åœ°æ–¹å¯ä»¥é€šè¿‡appdelegateè¿™ä¸ªå•ä¾‹æ‹¿åˆ°ï¼Œæƒ³å“ªé‡Œç”¨å°±å¯ä»¥åœ¨å“ªé‡Œç”¨ã€‚è¿™ä¸ªæ•°ç»„æ˜¯å­˜æ”¾æˆ‘çš„å…¨éƒ¨å¥½å‹ä¿¡æ¯çš„ï¼Œé‡Œé¢æ”¾çš„æ˜¯RCUserInfoï¼Œæ¯ä¸ªå¥½å‹éƒ½æ˜¯RCUserInfoçš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚
   self.friendsArray = [[NSMutableArray alloc]init];

    //æµ‹è¯•ç¯å¢ƒ          AppKey XXXXXAppKey      AppSecret XXXXXXAppSecret

    //æ­£å¼ä¸Šçº¿ç¯å¢ƒ       AppKey XXXXXAppKey      AppSecret  XXXXXAppKey

    NSString *rongYunKey = @"yourAPPKey";
//åˆ¤æ–­ç”¨æ­£å¼appkeyè¿˜æ˜¯æµ‹è¯•appkeyï¼Œæµ‹è¯•å¼€å‘ç¯å¢ƒæœ€å¥½ä¸è¦ç”¨æ­£å¼çš„keyå“¦ï¼Œä¸è¦æ€ªæˆ‘æ²¡æé†’ã€‚
    if ([kNetwork_Host isEqualToString:@"http://weixintest.ihk.cn"]) {//æ­£å¼ç¯å¢ƒç”¨æ­£å¼keyï¼Œå¼€å‘æµ‹è¯•ç¯å¢ƒç”¨æµ‹è¯•çš„key

        rongYunKey = @"your æ­£å¼appkey";

    }else{
            rongYunKey = @"your æµ‹è¯•appkey";

    }
//åˆå§‹åŒ–appkey
    [[RCIM sharedRCIM] initWithAppKey:rongYunKey];
//åˆå§‹åŒ–å…¨å±€çš„å•ä¾‹RCDataManagerï¼ˆèäº‘æ•°æ®ç®¡ç†è€…ï¼‰ï¼Œè¿™ä¸ªRCDataManageræŠŠæ‰€ä»¥èäº‘æœ‰å…³æ•°æ®çš„é€»è¾‘å’Œä»£ç åˆ†ç¦»äº†ï¼Œæ–¹ä¾¿è¯¥ï¼Œä¹Ÿæ–¹ä¾¿ç»´æŠ¤ã€‚è¿™é‡ŒæŠŠuserInfoDatasourceè®¾ç½®ä¸ºRCDataManagerã€‚
    [RCIM sharedRCIM].userInfoDataSource = [RCDataManager shareManager];

/**enableMessageAttachUserInfo
 *  é»˜è®¤NOï¼Œå¦‚æœYESï¼Œå‘é€æ¶ˆæ¯ä¼šåŒ…å«è‡ªå·±ç”¨æˆ·ä¿¡æ¯ã€‚
 */


    [RCIM sharedRCIM].enableMessageAttachUserInfo = YES;


//ç™»å½•èäº‘ï¼ˆæ³¨æ„è¿™é‡Œæ˜¯ç¬¬næ¬¡ç™»å½•ï¼Œn>1ï¼Œç¬¬ä¸€æ¬¡ç™»å½•çš„é€»è¾‘åœ¨ç™»å½•é¡µé¢ç‚¹å‡»ç™»å½•æŒ‰é’®çš„æ—¶å€™ï¼Œä¸€æ ·è°ƒç”¨è¿™å¥è¯ï¼Œå› ä¸ºé€»è¾‘å…¨äº¤ç»™RCDataManagerå¤„ç†äº†ï¼Œå¤–éƒ¨è°ƒç”¨æ–¹æ³•å³å¯ï¼‰
    [[RCDataManager shareManager] loginRongCloud];

}
```
  åˆå§‹åŒ–å®Œæˆåå°±æ˜¯æ‹¿`token`ï¼Œç„¶åç”¨ä¸€ä¸ªäººï¼ˆå½“å‰ç”¨æˆ·å•Šï¼‰çš„`userId`å»`connect`äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªé€»è¾‘æˆ‘æ²¡æœ‰æŠŠä»£ç å†™åœ¨`appdelegate`ï¼Œå› ä¸ºä¸šåŠ¡ç›¸åŒçš„é€»è¾‘åº”è¯¥åˆ†ç¦»å‡ºæ¥ï¼Œè¦ä¸å…¨éƒ¨ä»£ç å†™`appdelegate`é‡Œé¢å¤ªä¹±ï¼Œå¤ªéš¾ç»´æŠ¤ï¼Œæˆ‘ä»¬æŠŠæœ‰å…³èäº‘çš„é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼Œæ”¾ä¸€ä¸ªç±»`RCDataManager`ä¸­å»ç®¡ç†ï¼Œé‚£ä¹ˆæˆ‘çš„è¿™ä¸ª`RCDataManager`å®Œæˆäº†ä»€ä¹ˆåŠŸèƒ½ï¼Œä»€ä¹ˆé€»è¾‘ï¼Œå…·ä½“æ€ä¹ˆè®¾è®¡è¿™ä¸ªç±»ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ã€‚ä¸‹é¢è¯¦ç»†ä»‹ç»ä¸‹æ€ä¹ˆæŠŠèäº‘çš„é€»è¾‘æ¨¡å—åˆ†ç¦»å‡ºæ¥ï¼Œå†™å‡ºé«˜ä¸€ç‚¹è´¨é‡çš„ä»£ç ã€‚
`RCDataManager`æ˜¯ä¸ªå•ä¾‹ç±»ï¼Œä¸»è¦åŠŸèƒ½å°±æ˜¯ç™»å½•èäº‘ï¼Œåˆ·æ–°å¥½å‹åˆ—è¡¨ï¼Œè®¾ç½®å¥½å‹ä¿¡æ¯æä¾›è€…ä»£ç†ç­‰ç­‰ï¼Œè®¾ç½®`tabbar`çš„è§’æ ‡ç­‰ç­‰ã€‚ä»–çš„å¥½å¤„æ˜¯æŠŠèäº‘çš„é€»è¾‘åˆ†ç¦»å‡ºæ¥ï¼Œä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œæ–¹ä¾¿ç»´æŠ¤å·¥ç¨‹ï¼Œæˆ‘ä»¬ç”¨çš„æ—¶å€™å°±ä¸€å¥ä»£ç å°±å¯ä»¥äº†ï¼Œæ¯”å¦‚ç™»å½•å°±è¿™æ · `[[RCDataManager shareManager] loginRongCloud];`å…·ä½“`RCDataManager`ç±»çš„ä»£ç å¦‚ä¸‹ï¼š
```Objcect-C
@interface RCDataManager : NSObject<RCIMUserInfoDataSource>

RCIMUserInfoDataSourceæ˜¯èäº‘çš„å¥½å‹æä¾›è€…ä»£ç†ï¼Œå¾ˆé‡è¦ï¼Œéå¸¸é‡è¦ï¼ŒåŠå…¶é‡è¦ï¼Œéµå®ˆä¹‹ï¼Œå®ç°ä¹‹ã€‚





@property(nonatomic,assign)BOOL success;

+(RCDataManager *) shareManager;

- (void)getUserInfoWithUserId:(NSString*)userId completion:(void (^)(RCUserInfo*))completion;

/**

 *  ä»æœåŠ¡å™¨åŒæ­¥å¥½å‹åˆ—è¡¨

 */

-(BOOL)hasTheFriendWithUserId:(NSString *)userId;

-(void)loginRongCloud;
//åŒæ­¥å¥½å‹åˆ—è¡¨çš„æ–¹æ³•ï¼Œç”¨æ­¤æ–¹æ³•å¯ä»¥åˆ·æ–°åˆ°æœ€æ–°çš„å¥½å‹åˆ—è¡¨ï¼Œæ¯”å¦‚æœ‰æ–°æœ‹å‹äº†ï¼Œé‚£ä¹ˆå°±è¦åŒæ­¥ä¸€ä¸‹
-(void) syncFriendList:(void (^)(NSMutableArray * friends,BOOL isSuccess))completion;

-(void)refreshBadgeValue;

-(NSString *)currentNameWithUserId:(NSString *)userId;

-(RCUserInfo *)currentUserInfoWithUserId:(NSString *)userId;

@end

```


>å†çœ‹å®ç°æ–‡ä»¶é‡Œé¢çš„ä»£ç 

```Object-C
#import "RCDataManager.h"



@implementation RCDataManager{

    NSMutableArray *dataSoure;



}

- (instancetype)init{

    if (self = [super init]) {

        [RCIM sharedRCIM].userInfoDataSource = self;

        dataSoure = [[NSMutableArray alloc]init];

    }

    return self;

}



+ (RCDataManager *)shareManager{

    static RCDataManager* manager = nil;

    static dispatch_once_t predicate;

    dispatch_once(&predicate, ^{

        manager = [[[self class] alloc] init];

    });

    return manager;

}



-(void)syncFriendList:(void (^)(NSMutableArray* friends,BOOL isSuccess))completion

{
//è¿™é‡Œæ˜¯ç”¨æˆ·çš„èº«ä»½ï¼Œå¯èƒ½å…¶ä»–å¼€å‘è€…ä¸éœ€è¦è¿™ä¸ªé€»è¾‘ï¼Œä¸éœ€è¦çš„è¯ï¼Œå°±ç›´æ¥è°ƒç”¨å¥½å‹åˆ—è¡¨çš„æ¥å£ï¼Œæ‹¿åˆ°å¥½å‹åˆ—è¡¨çš„æ•°ç»„ï¼ŒåšæˆRCUserInfoï¼Œç„¶åaddè¿›å»æ•°ç»„ã€‚å°±è¿™ç®€å•ï¼
    UsersType type = [MSUtil checkUserType];

    if (type==UsersTypeYouke) {//æ¸¸å®¢

    //ä¸èƒ½èŠå¤©


    }

    else if(type==UsersTypeSales){//é”€å”®

        /* è·å–æˆ‘çš„å®¢æˆ·(åŒ…æ‹¬é”€å”®) */

        [Networking getMyClientsWithPage:@"1" pagesize:@"10000" success:^(NetworkModel *model) {

            NSLog(@"%@",model.msg);



            if ([model.data isKindOfClass:[NSString class]]) {

                //LOGIN_CHECK_NO

                NSLog(@"%@",model.data);

            }else if ([model.data isKindOfClass:[NSDictionary class]]){

                [dataSoure removeAllObjects];

            

                for (NSDictionary *infoDic in model.data[@"rows"]) {

                    RCUserInfo *userInfo = [[RCUserInfo alloc]init];

                    userInfo.userId = [NSString stringWithFormat:@"%@",infoDic[@"id"]];

//                    if ([[NSString stringWithFormat:@"%@",infoDic[@"salesNickName"]] isEqualToString:@""]) {

//                        userInfo.name = [NSString stringWithFormat:@"%@",infoDic[@"realName"]];

//                    }else{

//                        userInfo.name = [NSString stringWithFormat:@"%@  %@",infoDic[@"realName"],infoDic[@"salesNickName"]];

//                    }



                    userInfo.name = [[NSString stringWithFormat:@"%@",infoDic[@"realName"]] isEqualToString:@""]?[NSString stringWithFormat:@"%@",infoDic[@"loginName"]]:[NSStringstringWithFormat:@"%@",infoDic[@"realName"]];

                    userInfo.portraitUri = [NSString stringWithFormat:@"%@",infoDic[@"photo"]];

                    userInfo.phone = [NSString stringWithFormat:@"%@",infoDic[@"phone"]];

                    userInfo.addressInfo = [NSString stringWithFormat:@"%@",infoDic[@"company"]];

                    userInfo.realName = [NSString stringWithFormat:@"%@",infoDic[@"realName"]];



                    [dataSoure addObject:userInfo];

                    

                }

                [AppDelegate shareAppDelegate].friendsArray = dataSoure;

                completion(model.data[@"rows"],[model.result isEqualToString:@"10000"]?YES:NO);



                NSLog(@"å¥½å‹åˆ—è¡¨ = %@",[AppDelegate shareAppDelegate].friendsArray);

                if ([AppDelegate shareAppDelegate].friendsArray.count) {

                    NSLog(@"ä»æœåŠ¡å™¨åŒæ­¥å¥½å‹åˆ—è¡¨æˆåŠŸFFF");

                    [self loginRongCloud];

                    for (RCUserInfo *aUser in [AppDelegate shareAppDelegate].friendsArray) {

                        NSLog(@"name =%@ userId =%@",aUser.name ,aUser.userId);

                    }

                }

            }

            

        } fail:^(NSError *error) {

            NSLog(@"errorï¼ %@",error);

            NSLog(@"ä»æœåŠ¡å™¨åŒæ­¥å¥½å‹åˆ—è¡¨å¤±è´¥ ï½ï½ï½");



        }];

    }else if(type==UsersTypeCustomer){//ç”¨æˆ·

        [Networking getMyBrokerAppUsersWithPage:@"1" pagesize:@"10000" success:^(NetworkModel *model) {

            if ([model.data isKindOfClass:[NSString class]]) {

                

            }else if ([model.data isKindOfClass:[NSDictionary class]]){

                [dataSoure removeAllObjects];

    

                for (NSDictionary *infoDic in model.data[@"rows"]) {

                    

                    RCUserInfo *userInfo = [[RCUserInfo alloc]init];

                    userInfo.userId = [NSString stringWithFormat:@"%@",infoDic[@"id"]];

                    

                    userInfo.name = [[NSString stringWithFormat:@"%@",infoDic[@"salesNickName"]] isEqualToString:@""]?[NSString stringWithFormat:@"%@",infoDic[@"realName"]]:[NSStringstringWithFormat:@"%@",infoDic[@"salesNickName"]];

                    userInfo.portraitUri = [NSString stringWithFormat:@"%@",infoDic[@"photo"]];

                    userInfo.phone = [NSString stringWithFormat:@"%@",infoDic[@"phone"]];

                    userInfo.addressInfo = [NSString stringWithFormat:@"%@",infoDic[@"company"]];

                    userInfo.realName = [NSString stringWithFormat:@"%@",infoDic[@"realName"]];



                    [dataSoure addObject:userInfo];



                }

                [AppDelegate shareAppDelegate].friendsArray = dataSoure;

                NSLog(@"å¥½å‹åˆ—è¡¨ = %@",[AppDelegate shareAppDelegate].friendsArray);

                completion(model.data[@"rows"],[model.result isEqualToString:@"10000"]?YES:NO);



                if ([AppDelegate shareAppDelegate].friendsArray.count) {

                    NSLog(@"ä»æœåŠ¡å™¨åŒæ­¥å¥½å‹åˆ—è¡¨æˆåŠŸFFF");

                    if ([RCIMClient sharedRCIMClient].currentUserInfo.userId) {

                        

                    }else{

                        [self loginRongCloud];



                    }

                    for (RCUserInfo *aUser in [AppDelegate shareAppDelegate].friendsArray) {

                        NSLog(@"name = %@",aUser.name);

                        NSLog(@"name = %@",aUser.userId);

                    }

                }

            }

        } fail:^(NSError *error) {

            NSLog(@"error ï¼ %@",error);

            NSLog(@"ä»æœåŠ¡å™¨åŒæ­¥å¥½å‹åˆ—è¡¨å¤±è´¥ ï½ï½ï½");





        }];

    }

}

//è·å–ä¸€ä¸ªuserIdå¯¹åº”çš„å¥½å‹å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æˆ‘ä»¬å«åšRCUserInfoï¼Œè¿™ä¸ªæ˜¯èäº‘çš„ç±»ï¼Œæˆ‘ä»¬çœ‹çœ‹æºä»£ç çš„.hé‡Œé¢æ€ä¹ˆå†™

-(RCUserInfo *)currentUserInfoWithUserId:(NSString *)userId{

    for (NSInteger i = 0; i<[AppDelegate shareAppDelegate].friendsArray.count; i++) {

        RCUserInfo *aUser = [AppDelegate shareAppDelegate].friendsArray[i];

        if ([userId isEqualToString:aUser.userId]) {

            NSLog(@"current ï¼ %@",aUser.name);

            return aUser;

        }

    }

    return nil;

}

è¿™æ˜¯RCUserInfoçš„.h
/**

 *  ç”¨æˆ·ä¿¡æ¯ç±»

 */

@interface RCUserInfo : NSObject <NSCoding>

/** ç”¨æˆ·ID */

@property(nonatomic, strong) NSString *userId;

/** ç”¨æˆ·å*/

@property(nonatomic, strong) NSString *name;

/** å¤´åƒURL*/

@property(nonatomic, strong) NSString *portraitUri;



/**

 *  æŒ‡æ´¾çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œæ ¹æ®ç»™å®šå­—æ®µåˆå§‹åŒ–å®ä¾‹

 *

 *  @param userId       ç”¨æˆ·ID

 *  @param username     ç”¨æˆ·å

 *  @param portrait     å¤´åƒURL

 */
- (instancetype)initWithUserId:(NSString *)userId name:(NSString *)username portrait:(NSString *)portrait;
```
è¿™ä¸ªç±»å°±ä¸€ä¸ª`model`ç±»ï¼Œä¿å­˜äº†ä¸€ä¸ªäººçš„ç”¨æˆ·ä¿¡æ¯ï¼Œæœ‰ä¸‰ä¸ªï¼Œ`userId`ï¼ˆå”¯ä¸€idï¼‰ï¼Œ`name`åå­—ï¼Œ`portraitUri`å¤´åƒåœ°å€`url string`ï¼Œç±»ä¸­æä¾›äº†ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œä¼ ä¸‰ä¸ªå‚æ•°å°±å¯ä»¥äº†ï¼Œå¤´åƒå¯ä»¥ç”¨`nil`ï¼Œä¼ `nil`å°±ç”¨é»˜è®¤å¤´åƒã€‚å¤§å®¶çœ‹çœ‹æˆ‘çš„`RCDataManager`ç±»ä¸­ç”¨åˆ°çš„`RCUserInfo`çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯ä¸ä¸€æ ·ï¼Œ
```Object-C
        RCUserInfo *aUser = [[RCUserInfo alloc]initWithUserId:myselfInfo.userId name:myselfInfo.realNameportrait:myselfInfo.photo phone:myselfInfo.phone addressInfo:myselfInfo.companyrealName:myselfInfo.realName];
```
æˆ‘`category`äº†`RCUserInfo`æ·»åŠ äº†æˆ‘è¦çš„å±æ€§è¿›å»ï¼Œæ¯”å¦‚å…¬å¸åå­—ï¼Œåœ°å€ï¼ŒçœŸæ˜¯åå­—ç­‰ç­‰ã€‚åœ¨å¼€å‘ä¸­å¦‚æœè§‰å¾—`RCUserInfo`ç±»ä¸­çš„å±æ€§ä¸å¤Ÿç”¨ï¼Œå¯èƒ½å¼€å‘è€…è¿˜éœ€è¦æ¯ä¸ªç”¨æˆ·å¸¦æœ‰æ›´å¤šçš„å±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨æˆ‘çš„æ–¹æ³•ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªç”¨æˆ·èº«ä¸Šå°±ç»‘å®šäº†å¾ˆå¤šçš„å±æ€§ï¼Œæƒ³æ€ä¹ˆç”¨å°±æ€ä¹ˆç”¨ã€‚
é‚£ä¹ˆç´§æ¥ç€æˆ‘æŠŠ`RCUserInfo`çš„ç»™å¤§å®¶å±•ç¤ºä¸‹ï¼Œè¿™ä¸ªå¯èƒ½å¤§éƒ¨åˆ†å¼€å‘è€…éƒ½æœ‰è¿™ä¸ªéœ€æ±‚ã€‚æˆ‘æ˜¯ä¹‹ä¸€ï¼ŒåºŸè¯ä¸è¯´ï¼Œç›´æ¥ä¸Šä»£ç çœ‹`.h`
```Object-C
#import <RongIMLib/RongIMLib.h>

@interface RCUserInfo (Addition)

/**

 ç”¨æˆ·ä¿¡æ¯ç±»

 */

/** ç”¨æˆ·ID */

@property(nonatomic, strong) NSString *userId;

/** ç”¨æˆ·å*/

@property(nonatomic, strong) NSString *name;

/** å¤´åƒURL*/

@property(nonatomic, strong) NSString *portraitUri;

/** phone*/

@property(nonatomic, strong) NSString *phone;



/** addressInfo*/

@property(nonatomic, strong) NSString *addressInfo;





/** realName*/

@property(nonatomic, strong) NSString *realName;



/**

 

 æŒ‡æ´¾çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œæ ¹æ®ç»™å®šå­—æ®µåˆå§‹åŒ–å®ä¾‹

 

 @param userId          ç”¨æˆ·ID

 @param username        ç”¨æˆ·å

 @param portrait        å¤´åƒURL

 @param phone           ç”µè¯

 @param addressInfo     addressInfo

 */

- (instancetype)initWithUserId:(NSString *)userId name:(NSString *)username portrait:(NSString *)portrait phone:(NSString *)phone addressInfo:(NSString *)addressInfo realName:(NSString *)realName;

@end



å†çœ‹RCUerInfoçš„categoryçš„.mæ–‡ä»¶ã€‚è¿™é‡Œç”¨äº†runtimeçš„çŸ¥è¯†ï¼Œä¸æ‡‚çš„è¯·è‡ªè¡Œç™¾åº¦æˆ–è€…å‚è€ƒæ­¤é“¾æ¥http://www.cnblogs.com/wupher/archive/2013/01/05/2845338.html
#import "RCUserInfo+Addition.h"

#import <objc/runtime.h>


@implementation RCUserInfo (Addition)

@dynamic addressInfo;

@dynamic phone;

- (instancetype)initWithUserId:(NSString *)userId name:(NSString *)username portrait:(NSString *)portrait phone:(NSString *)phone addressInfo:(NSString *)addressInfo realName:(NSString *)realName{

    if (self = [super init]) {

        self.userId        =   userId;

        self.name          =   username;

        self.portraitUri   =   portrait;

        self.phone         =   phone;

        self.addressInfo   =   addressInfo;

        self.realName     =   realName;



    }

    return self;

}



//æ·»åŠ å±æ€§æ‰©å±•setæ–¹æ³•

char* const PHONE = "PHONE";

char* const ADDRESSINFO = "ADDRESSINFO";

char* const REALNAME   = "REALNAME";



-(void)setPhone:(NSString *)newPhone{

    

    objc_setAssociatedObject(self,PHONE,newPhone,OBJC_ASSOCIATION_RETAIN_NONATOMIC);

    

}

-(void)setAddressInfo:(NSString *)newAddressInfo{

    

    objc_setAssociatedObject(self,ADDRESSINFO,newAddressInfo,OBJC_ASSOCIATION_RETAIN_NONATOMIC);



}

-(void)setRealName:(NSString *)nweRealName{   

    objc_setAssociatedObject(self,REALNAME,nweRealName,OBJC_ASSOCIATION_RETAIN_NONATOMIC);

}

//æ·»åŠ å±æ€§æ‰©å±•getæ–¹æ³•

-(NSString *)phone{

    return objc_getAssociatedObject(self,PHONE);

}

-(NSString *)addressInfo{

    return objc_getAssociatedObject(self,ADDRESSINFO);

}

-(NSString *)realName{

    return objc_getAssociatedObject(self,REALNAME);

}
@end



//è·å–ä¸€ä¸ªuserIdçš„å¥½å‹çš„åå­—

-(NSString *)currentNameWithUserId:(NSString *)userId{

    for (NSInteger i = 0; i<[AppDelegate shareAppDelegate].friendsArray.count; i++) {

        RCUserInfo *aUser = [AppDelegate shareAppDelegate].friendsArray[i];

        if ([userId isEqualToString:aUser.userId]) {

            NSLog(@"current ï¼ %@",aUser.name);

            return aUser.name;

        }

    }

    return nil;

}

//è¿™ä¸ªä»£ç†æ–¹æ³•å¾ˆé‡è¦ï¼Œå¥½å‹ä¿¡æ¯çš„æä¾›è€…ï¼Œå•ä¾‹çš„æ—¶å€™ï¼Œæ˜¯ä¸€å®šè¦å®ç°è¿™ä¸ªä»£ç†æ–¹æ³•çš„ï¼Œå¹¶æŠŠä½ çš„å¥½å‹ä¿¡æ¯ç”¨ä¸€ä¸ªforå¾ªç¯ç»™completionã€‚

#pragma mark - RCIMUserInfoDataSource

- (void)getUserInfoWithUserId:(NSString*)userId completion:(void (^)(RCUserInfo*))completion

{

    NSLog(@"getUserInfoWithUserId ----- %@", userId);

    

    if (userId == nil || [userId length] == 0 )

    {

        completion(nil);

        return ;

    }

   

    if ([userId isEqualToString:[RCIM sharedRCIM].currentUserInfo.userId]) {

        UserInfoModel *myselfInfo = [UserInfoModel currentUserinfo];

        RCUserInfo *aUser = [[RCUserInfo alloc]initWithUserId:myselfInfo.userId name:myselfInfo.realNameportrait:myselfInfo.photo phone:myselfInfo.phone addressInfo:myselfInfo.companyrealName:myselfInfo.realName];

        completion(aUser);

    }

    

    for (NSInteger i = 0; i<[AppDelegate shareAppDelegate].friendsArray.count; i++) {

        RCUserInfo *aUser = [AppDelegate shareAppDelegate].friendsArray[i];

        if ([userId isEqualToString:aUser.userId]) {

            completion(aUser);

        }

    }

}

//ç™»å½•èäº‘

-(void)loginRongCloud{

    UserInfoModel *userinfo = [UserInfoModel currentUserinfo];

    if (userinfo.login==YES&&![userinfo.userId isEqualToString:@""]&&![RCIMClientsharedRCIMClient].currentUserInfo.userId) {

        [Networking getAppUserTokenWithUserId:userinfo.userId name:userinfo.realNameportraitUri:userinfo.photo success:^(NetworkModel *model) {

            if ([model.result isEqualToString:@"10000"]) {

                NSLog(@"RCToken = %@",model.data);//model.dataå°±æ˜¯æˆ‘ä»¬çš„tokenå•¦ï¼Œæœ‰äº†ä»–ï¼Œæˆ‘ä»¬æ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥connect

                self.success = YES;

                [[RCIM sharedRCIM] connectWithToken:model.data success:^(NSString *userId) {

                    [RCIM sharedRCIM].globalNavigationBarTintColor = [UIColor whiteColor];

                    NSLog(@"login success with userId %@",userId);

                    [UserInfoModel loginUserinfo:model];

                    //åŒæ­¥å¥½å‹åˆ—è¡¨

                    [self syncFriendList:^(NSMutableArray *friends, BOOL isSuccess) {

                        NSLog(@"%@",friends);

                        if (isSuccess) {

                            NSLog(@" success å‘é€é€šçŸ¥");

                            [[NSNotificationCenter defaultCenter] postNotificationName:@"alreadyLogin"object:nil];

                        }

                    }];

//ç™»å½•æˆåŠŸï¼Œè®¾ç½®å½“å‰ç”¨æˆ·æ˜¯XXX

                    [RCIMClient sharedRCIMClient].currentUserInfo = [[RCUserInfo alloc] initWithUserId:userinfo.userId name:userinfo.userName portrait:userinfo.photo phone:userinfo.phoneaddressInfo:userinfo.company realName:userinfo.realName];

                   

                    

                    [[RCDataManager shareManager] refreshBadgeValue];

                } error:^(RCConnectErrorCode status) {

                    NSLog(@"status = %ld",(long)status);

                } tokenIncorrect:^{

                    self.success = NO;

                    [MSUtil showTipsWithHUD:@"tokenIncorrect"];

                }];

            }

            

        } fail:^(NSError *error) {

            NSLog(@"error %@",error);

            self.success = NO;

        }];

    }else{



    }

}

//åˆ·æ–°è§’æ ‡

-(void)refreshBadgeValue{

    

    dispatch_async(dispatch_get_main_queue(), ^{

        

        int notReadMessage = [[UserInfoModel currentUserinfo].notReadMessage intValue];

        

        NSInteger unreadMsgCount = (NSInteger)[[RCIMClient sharedRCIMClient] getUnreadCount:@[@(ConversationType_PRIVATE)]];

        BaseNavigationController  *chatNav = [AppDelegate shareAppDelegate].rootTabbar.viewControllers[2];

        if (unreadMsgCount == 0) {

            chatNav.tabBarItem.badgeValue = nil;

            if (notReadMessage > 0) {

                [UIApplication sharedApplication].applicationIconBadgeNumber = notReadMessage;

            }

            else {

                [UIApplication sharedApplication].applicationIconBadgeNumber = 0;

            }



        }else{

            chatNav.tabBarItem.badgeValue = [NSString stringWithFormat:@"%li",(long)unreadMsgCount];

            if (notReadMessage > 0) {

                [UIApplication sharedApplication].applicationIconBadgeNumber = unreadMsgCount + notReadMessage;

            }

            else {

                [UIApplication sharedApplication].applicationIconBadgeNumber = unreadMsgCount;

            }



        }

    });

}

//åˆ¤æ–­æœ‰æ²¡æœ‰è¿™ä¸ªå¥½å‹

-(BOOL)hasTheFriendWithUserId:(NSString *)userId{

    if ([AppDelegate shareAppDelegate].friendsArray.count) {

        NSMutableArray *tempArray = [[NSMutableArray alloc]init];



        for (RCUserInfo *aUserInfo in [AppDelegate shareAppDelegate].friendsArray) {

            [tempArray addObject:aUserInfo.userId];

        }

        

        if ([tempArray containsObject:userId]) {

            return YES;

        }

    }
    return NO;

}

@end
```

###å¥½ï¼Œåˆ°æ­¤å¤„ï¼Œå·²ç»æŠŠèäº‘çš„é€»è¾‘åˆ†ç¦»å‡ºæ¥ï¼Œå¹¶ä¸”ç™»å½•äº†èäº‘æœåŠ¡å™¨ã€‚ä¸‹ä¸€ç¯‡ç« è¯¥è®²å¦‚ä½•èŠå¤©ï¼Œç”ŸæˆèŠå¤©åˆ—è¡¨ï¼Œæ˜¾ç¤ºå¤´åƒåå­—ç­‰ã€‚
æŒç»­å…³æ³¨ï¼ŒæŒç»­æ›´æ–°ï¼Œè°¢è°¢ã€‚åšä¸»åŸåˆ›ï¼Œä¸å¾—è½¬è½½ï¼Œè°¢è°¢ã€‚



>ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼





 ##è¯´è¯´èäº‘å³æ—¶é€šè®¯`SDK`å¼€å‘ç¯‡(ä¸‰)
 
 
æ¥ç€å¼€å‘ç¯‡äºŒçš„å†…å®¹ï¼Œæˆ‘ä»¬å·²ç»æŠŠèäº‘çš„é€»è¾‘åˆ†ç¦»å‡ºæ¥ï¼Œå¹¶ä¸”ç™»å½•äº†èäº‘æœåŠ¡å™¨ã€‚æ­¤ç¯‡ç« è®²å¦‚ä½•èŠå¤©ï¼Œç”ŸæˆèŠå¤©åˆ—è¡¨ï¼Œæ˜¾ç¤ºå¤´åƒåå­—ç­‰ã€‚
 å„ä¸ª`APP`çš„ç•Œé¢`UI`è®¾è®¡çš„ä¸åŒï¼Œæ¯ä¸ªå¼€å‘è€…çš„éœ€æ±‚ä¹Ÿä¸åŒï¼Œä½†æ˜¯ä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œæˆ‘ä»¬æŠ“ä½ä¸å˜çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯å…±åŒä¹‹å¤„ã€‚é‚£ä¹ˆå…±åŒä¹‹å¤„åœ¨å“ªé‡Œï¼Ÿå°±æ˜¯æˆ‘ä»¬è¦è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œæ¯”å¦‚ç‚¹å‡»äº†ä¸€ä¸ª`cell`ï¼Œæˆ–è€…ç‚¹å‡»äº†ä¸€ä¸ª`Button`ï¼Œåˆæˆ–è€…æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªæ¥å£åå°è¿”å›ç»™æˆ‘ä»¬ä¸€ä¸ªäººçš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå„ä¸ªå¼€å‘è€…è§¦å‘è¿™ä¸€ç³»åˆ—çš„äº‹ä»¶éƒ½æ˜¯ä¸ºäº†å’ŒæŸä¸ªäººèŠå¤©ï¼Œè§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€å®šè¦æ‹¿åˆ°å¯¹åº”äº‹ä»¶çš„è¿™ä¸ªäººçš„ä¿¡æ¯ï¼ˆ`userInfo`ï¼ŒåŒ…å«å¾ˆå¤šå­—æ®µï¼Œå„ä¸ªå¼€å‘è€…éœ€æ±‚ä¸åŒï¼Œå­—æ®µè‚¯å®šå°±ä¸åŒï¼Œä½†æ˜¯`userId`ä¸€å®šæœ‰çš„ï¼Œè¿™ä¸ªæ˜¯ç›¸åŒä¹‹å¤„ï¼‰ã€‚ä¸¾ä¸ªæ —å­ï¼Œæ¯”å¦‚è¿›å…¥ä¸€ä¸ª`tableView`å±•ç¤ºçš„åˆ—è¡¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç‚¹å‡»`cell`ï¼ŒåŠ¨æ€çš„å»å–åˆ°æ¯ä¸ª`cell`å¯¹åº”åˆ°äººçš„ä¿¡æ¯ï¼Œç„¶åå°±æ˜¯åœ¨ç‚¹å‡»`cell`çš„äº‹ä»¶é‡Œé¢é…ç½®æˆ‘ä»¬`ConversationViewController`çš„å±æ€§äº†ï¼Œé‚£ä¹ˆä»£ç åœ¨ä¸‹é¢ã€‚
      
  ```Object-C    
 ConversationViewController *_conversationVC = [[ConversationViewController alloc]init];
                                _conversationVC.conversationType = ConversationType_PRIVATE;
                                _conversationVC.targetId = [NSString stringWithFormat:@"%@",model.data[@"id"]];
                                
                                _conversationVC.userName = [NSString stringWithFormat:@"%@",model.data[@"agentTeamName"]];
                                _conversationVC.title = [NSString stringWithFormat:@"%@",model.data[@"realName"]];
[self.navigationController pushViewController:_conversationVC animated:YES];
```
 è¿™é‡Œçš„`ConversationViewController`æ˜¯æˆ‘è‡ªå·±çš„VCç»§æ‰¿`RCConversationViewController`ï¼Œ`RCConversationViewController`æ˜¯ç”¨çš„èäº‘å†™çš„`UI`ï¼Œå°±æ˜¯è¯´è¿™ä¸ª`RCConversationViewController`é‡Œé¢çš„`UI`å…¨éƒ¨å†™å¥½äº†ï¼Œå°±å¾ˆç±»ä¼¼`QQèŠå¤©`çš„ç•Œé¢ï¼Œ`é”®ç›˜`ï¼Œ`è¡¨æƒ…`ï¼Œ`å‘é€å›¾ç‰‡`ï¼Œ`å‘é€è¯­éŸ³`ï¼Œä¸€åˆ‡çš„ä¸€åˆ‡éƒ½æå®šäº†ã€‚æˆ‘ä»¬åªéœ€è¦é…ç½®ä¸€äº›å±æ€§ï¼Œç„¶å`push`å°±å¯ä»¥äº†ã€‚å¦‚æœæˆ‘ä»¬æœ‰è‡ªå·±çš„éœ€æ±‚`UI`ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€‚å½“çš„åœ¨`ConversationViewController`åŸºç¡€ä¸Šä¿®æ”¹ã€‚ï¼ˆå…³äº`RCConversationViewController`é‡Œé¢å¾ˆå¤šæ–¹æ³•å’Œå±æ€§ï¼Œåç»­ä¼šæ…¢æ…¢æ¶‰åŠåˆ°ï¼Œç°åœ¨åŠŸèƒ½ä¸Šæ²¡æœ‰æ¶‰åŠï¼Œæ‰€ä»¥å…ˆä»‹ç»åˆ°è¿™é‡Œï¼Œåç»­è®²è§£æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œå°±å¯ä»¥æŠŠæ›´å¤šçš„APIç»™å¸¦å‡ºæ¥ï¼Œè¿™æ ·æ‰æœ‰ä½¿ç”¨çš„åœºæ™¯ï¼Œæ‰æ›´å®¹æ˜“ç†è§£ã€‚ï¼‰
 
é‚£ä¹ˆæ¯ä¸ª`app`å‡ ä¹éƒ½ä¼šæœ‰ç±»ä¼¼èŠå¤©åˆ—è¡¨çš„ç•Œé¢ã€‚æè¿°ä¸€ä¸‹ï¼Œå°±æ˜¯èŠå¤©ä¹‹åä¼šç”Ÿæˆ`cell`çš„ï¼Œæ¯”å¦‚ä½ ç‚¹å‡»äº†10ä¸ªäººçš„ä¸»é¡µé‡Œé¢çš„èŠå¤©æŒ‰é’®ï¼Œç„¶åå’Œè¿™10ä¸ªè®©èŠè¿‡å¤©ï¼Œé‚£ä¹ˆèŠå¤©åˆ—è¡¨å°±æœ‰10ä¸ª`cell`è‡ªåŠ¨ç”Ÿæˆï¼ˆèäº‘å†…éƒ¨å°è£…å¥½çš„ï¼Œç†è§£ä¸ºèäº‘çš„æœºåˆ¶ï¼Œä¸è¦è¿‡åˆ†å¼ºæ±‚çš„åˆ†ææ˜¯æ€ä¹ˆå›äº‹ã€‚ï¼‰ã€‚å¯¹åº”åœ¨èäº‘è¿™è¾¹çš„ç±»å°±æ˜¯`RCConversationListViewController`ï¼Œæ³¨æ„ï¼Œè¿™ä¸ª`RCConversationListViewController`æˆ‘ä»¬ä¹Ÿä¸èƒ½ç›´æ¥ç”¨å•Šï¼Œæˆ‘ä»¬ä¹Ÿè¦å†™ä¸€ä¸ªè‡ªå·±çš„VCï¼Œé‚£å°±æ˜¯`ChatViewController`ç»§æ‰¿èäº‘çš„`RCConversationListViewController`ï¼Œè¿™ä¸ª`ChatViewController`å°±æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„èŠå¤©åˆ—è¡¨äº†ï¼Œæˆ‘ä»¬ä¸€æ—¦æœ‰å’ŒæŸäººèŠå¤©ï¼Œé‚£ä¹ˆè‡ªåŠ¨ä¼šç”Ÿæˆä¸€ä¸ª`cell`åˆ°è¿™ä¸ª`vc`é‡Œé¢ï¼Œé‡Œé¢çš„æœºåˆ¶å¤§å®¶ä¸è¦å»è¯•å›¾ç†è§£äº†ï¼Œèäº‘å·²ç»å°è£…å¥½äº†ï¼Œä¸€æ—¦ä½ å’Œè€ç‹ï¼Œå‰æä½ ç™»å½•äº†èäº‘æœåŠ¡å™¨ï¼Œå¹¶ä¸”è€ç‹æ˜¯ä½ çš„å¥½å‹ï¼Œé‚£ä¹ˆä½ èŠå¤©åå°±å¯ä»¥å›æ¥è¿™ä¸ª`vc`çœ‹äº†ï¼Œè‚¯å®šå‡ºäº†ä¸€ä¸ª`cell`ï¼Œæ˜¾ç¤ºçš„æ˜¯è€ç‹çš„åå­—å’Œå¤´åƒã€‚é‚£ä¹ˆä¸‹é¢æˆ‘å°±æŠŠè¿™ä¸ªèŠå¤©åˆ—è¡¨`VC`çš„åŠŸèƒ½å’Œ`API`è¯¦ç»†çš„ä»‹ç»ä¸‹ï¼Œç»§ç»­å¤§å°ºåº¦ï¼ˆæ²¡æœ‰äººå…¶ä»–äººæ„¿æ„è¿™ä¹ˆå¤§å°ºåº¦äº†ï¼Œç»å¯¹çš„ç¦åˆ©ï¼‰çš„è´´ä»£ç ï¼š
 ` .hé‡Œé¢ä»£ç `
  ```Object-C   
  #import "BaseViewController.h"

@interface ChatViewController : RCConversationListViewController


@end
å†çœ‹.må®ç°æ–‡ä»¶é‡Œé¢ä»£ç 
#import "ChatViewController.h"
#import "RCCustomCell.h"
#import "LoginViewController.h"
#import "SpecialAgentViewController.h"

@interface ChatViewController ()<RCIMReceiveMessageDelegate,RCIMConnectionStatusDelegate
,UIAlertViewDelegate,UITableViewDataSource,UITableViewDelegate>{
    UIView *bgView;
    UILabel *desLabel;
    UIImageView *defaultIV;
    UIView *firstShowView;
    UIImageView  *headerIV;
    MBProgressHUD *hud;
    UIImageView *aIV;
    UILabel *aLabel;
}

@end

@implementation ChatViewController

- (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self name:RCKitDispatchMessageNotification object:nil];
}


- (instancetype)init{
    self = [super init];
    if (self) {
        [[UIApplication sharedApplication]setStatusBarStyle:UIStatusBarStyleLightContent];
        [self setConversationAvatarStyle:RC_USER_AVATAR_CYCLE];
        [self setDisplayConversationTypes:@[@(ConversationType_PRIVATE)]];//è¿™é‡Œæ˜¯ä¼šè¯ç±»å‹ï¼Œæˆ‘åªç”¨å•èŠï¼Œæ‰€ä»¥æ˜¯ConversationType_PRIVATEï¼Œå¦‚æœä½ çš„è¿˜æœ‰ç¾¤èŠï¼Œç­‰ï¼Œé‚£ä¹ˆç‚¹è¿›å»ï¼Œçœ‹åˆ°ä¸€ä¸ªæšä¸¾ï¼Œæ‰¾åˆ°ä»–ä»¬ï¼Œéœ€è¦ä»€ä¹ˆç±»å‹å°±åŠ ä»€ä¹ˆç±»å‹
        [RCIM sharedRCIM].receiveMessageDelegate = self;//è¿™ä¸ªæ˜¯æ¥æ”¶æ¶ˆæ¯çš„ç›‘å¬ä»£ç†
        [RCIM sharedRCIM].connectionStatusDelegate = self;
        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(didReceiveMessageNotification:)name:RCKitDispatchMessageNotification object:nil];
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(removeLoginHud:) name:@"alreadyLogin" object:nil];
        hud = [[MBProgressHUD alloc]initWithView:self.view];
        hud.square = YES;
        [self.view addSubview:hud];
        
    }
    return self;
}

/**
 * @brief ç”Ÿæˆå½“å¤©çš„æŸä¸ªç‚¹ï¼ˆè¿”å›çš„æ˜¯ä¼¦æ•¦æ—¶é—´ï¼Œå¯ç›´æ¥ä¸å½“å‰æ—¶é—´[NSDate date]æ¯”è¾ƒï¼‰
 * @param hour å¦‚hourä¸ºâ€œ8â€ï¼Œå°±æ˜¯ä¸Šåˆ8:00ï¼ˆæœ¬åœ°æ—¶é—´ï¼‰
 */
- (NSDate *)getCustomDateWithHour:(NSInteger)hour
{
    //è·å–å½“å‰æ—¶é—´
    NSDate *currentDate = [NSDate date];
    NSCalendar *currentCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    NSDateComponents *currentComps = [[NSDateComponents alloc] init];
    
    NSInteger unitFlags = NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit | NSWeekdayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit;
    
    currentComps = [currentCalendar components:unitFlags fromDate:currentDate];
    
    //è®¾ç½®å½“å¤©çš„æŸä¸ªç‚¹
    NSDateComponents *resultComps = [[NSDateComponents alloc] init];
    [resultComps setYear:[currentComps year]];
    [resultComps setMonth:[currentComps month]];
    [resultComps setDay:[currentComps day]];
    [resultComps setHour:hour];
    
    NSCalendar *resultCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    return [resultCalendar dateFromComponents:resultComps];
}
// @param message æ”¶åˆ°çš„æ¶ˆæ¯å®ä½“ã€‚
// @param nLeft   å‰©ä½™æ¶ˆæ¯æ•°ã€‚
// è¿™é‡Œæ˜¯èäº‘çš„ç›‘å¬æ¶ˆæ¯äº‹ä»¶ï¼Œè¿™ä¸ªä»£ç†ä¼šåœ¨æ¯æ¬¡æ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™èµ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¤„ç†é€»è¾‘äº†ï¼Œæˆ‘å¤„ç†çš„é€»è¾‘æœ‰å‹¿æ‰°æ—¶æ®µå’Œå¤´åƒçš„åŠæ—¶æ›´æ–°ç­‰ç­‰
-(void)onRCIMReceiveMessage:(RCMessage *)message left:(int)left
{

    
  /*  è¿™ä¸ªRCMessageæ˜¯èäº‘çš„æ¶ˆæ¯ä½“ï¼Œæˆ‘å§‘ä¸”ç§°ä»–ä¸ºæ¶ˆæ¯ä½“ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½æ˜¯æ¶ˆæ¯ä½“ï¼Œæ¶ˆæ¯ä½“æœ¬èº«å¸¦æœ‰å¾ˆå¤šçš„ä¿¡æ¯ï¼Œæˆ‘è´´ä¸Šèäº‘æºä»£ç ï¼Œå¤§å®¶çœ‹çœ‹
    @interface RCMessage : NSObject <NSCopying, NSCoding>
/** ä¼šè¯ç±»å‹ */
@property(nonatomic, assign) RCConversationType conversationType;
/** ç›®æ ‡IDï¼Œå¦‚è®¨è®ºç»„ID, ç¾¤ID, èŠå¤©å®¤ID */
@property(nonatomic, strong) NSString *targetId;
/** æ¶ˆæ¯ID */
@property(nonatomic, assign) long messageId;
/** æ¶ˆæ¯æ–¹å‘ */
@property(nonatomic, assign) RCMessageDirection messageDirection;
/** å‘é€è€…ID */
@property(nonatomic, strong) NSString *senderUserId;
/** æ¥å—çŠ¶æ€ */
@property(nonatomic, assign) RCReceivedStatus receivedStatus;
/**å‘é€çŠ¶æ€ */
@property(nonatomic, assign) RCSentStatus sentStatus;
/** æ¥æ”¶æ—¶é—´ */
@property(nonatomic, assign) long long receivedTime;
/**å‘é€æ—¶é—´ */
@property(nonatomic, assign) long long sentTime;
/** æ¶ˆæ¯ä½“åç§° */
@property(nonatomic, strong) NSString *objectName;
/** æ¶ˆæ¯å†…å®¹ */
@property(nonatomic, strong) RCMessageContent *content;
/** é™„åŠ å­—æ®µ */
@property(nonatomic, strong) NSString *extra;

/**
 *  æŒ‡æ´¾åˆå§‹åŒ–æ–¹æ³•ï¼Œæ ¹æ®ç»™å®šä¿¡æ¯åˆå§‹åŒ–å®ä¾‹
 *
 *  @param  conversationType    ä¼šè¯ç±»å‹
 *  @param  targetId            ç›®æ ‡IDï¼Œå¦‚è®¨è®ºç»„ID, ç¾¤ID, èŠå¤©å®¤ID
 *  @param  messageDirection    æ¶ˆæ¯æ–¹å‘
 *  @param  messageId           æ¶ˆæ¯ID
 *  @param  content             æ¶ˆæ¯ä½“å†…å®¹å­—æ®µ
 */
- (instancetype)initWithType:(RCConversationType)conversationType
                    targetId:(NSString *)targetId
                   direction:(RCMessageDirection)messageDirection
                   messageId:(long)messageId
                     content:(RCMessageContent *)content;

/**
 *  æ ¹æ®æœåŠ¡å™¨è¿”å›JSONåˆ›å»ºæ–°å®ä¾‹
 *
 *  @param  jsonData    JSONæ•°æ®å­—å…¸
 */
+ (instancetype)messageWithJSON:(NSDictionary *)jsonData;
+ 

*/
```
æ¥ç€ï¼Œåˆ«çœ‹æ™•å–½ï¼Œè¿™ä¸ªæ¶ˆæ¯ä½“æ˜¯ä¸æ˜¯å¾ˆå¤šä¿¡æ¯åœ¨é‡Œé¢ï¼Œé‚£ä¹ˆæˆ‘éœ€è¦çš„å°±æ˜¯è¿™ä¸ª`content`å­—æ®µï¼Œä»¥åŠè¿™ä¸ª`extra`ã€‚æˆ‘ç°åœ¨ç»™å‡ºä¸€ä¸ªæ€è·¯å»è§£å†³å¥½å‹å¤´åƒæ›´æ–°ä¹‹åï¼Œæˆ‘ä¸èƒ½é©¬ä¸Šçœ‹åˆ°å¥½å‹çš„æ–°å¤´åƒé—®é¢˜ã€‚é‚£ä¹ˆå‡è®¾æˆ‘å’Œè€ç‹æ­£åœ¨èŠå¤©ï¼ŒèŠçš„å¾ˆçƒ­ä¹ï¼Œçªç„¶è€ç‹å»è®¾ç½®é‡Œé¢æ›´æ–°äº†ä¸ªå¤´åƒï¼Œæˆ‘è¿˜ç»§ç»­å’Œè€ç‹èŠå¤©ï¼Œæˆ‘èƒ½çœ‹åˆ°è€ç‹çš„æ–°å¤´åƒå—ï¼Ÿä½ çŒœçŒœï¼Œå¦‚æœä½ æ·±å…¥çš„çœ‹äº†ç†è®ºç¯‡ï¼Œå¹¶åˆ‡ç†è§£äº†ç†è®ºç¯‡ï¼Œä½ å°±å¾ˆæ¸…æ¥šçš„çŸ¥é“ï¼Œæˆ‘è‚¯å®šæ˜¯çœ‹ä¸åˆ°è€ç‹çš„æ–°å¤´åƒçš„ï¼Œä¸ºä»€ä¹ˆï¼Œå› ä¸ºæˆ‘`app`å¯åŠ¨çš„æ—¶å€™å°±æŠŠè€ç‹çš„ä¿¡æ¯ä¿å­˜åˆ°å…¨å±€æ•°ç»„é‡Œé¢äº†ï¼Œè€Œä¸”èäº‘çš„èŠå¤©åˆ—è¡¨å®é™…ä¸Šæ˜¯æœ‰ç¼“å­˜çš„ï¼Œæˆ‘çŒœæµ‹æ˜¯ç”¨æ•°æ®åº“å­˜å‚¨çš„ã€‚æ‰€ä»¥æˆ‘ä¸ä»æ–°å¯åŠ¨`app`çš„æƒ…å†µä¸‹ï¼Œæˆ‘æ˜¯ä¸å¯èƒ½çœ‹åˆ°è€ç‹çš„æ–°å¤´åƒçš„ã€‚é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ
 æ–¹æ¡ˆæœ‰ä¸¤ä¸ªï¼š
  ç¬¬ä¸€ä¸ªï¼Œè°æ›´æ–°äº†å¤´åƒå°±è¦ç»™ä»–è‡ªå·±çš„æ‰€æœ‰å¥½å‹å‘é€é€šçŸ¥æ¶ˆæ¯ï¼Œè¿™ä¸ªæ˜¯èäº‘å®˜æ–¹ç»™çš„æ–¹æ¡ˆï¼Œæˆ‘æ„Ÿè§‰ä¸æ˜¯å¤ªå¥½ï¼Œè¿™æ˜¯ç®€å•ç²—æš´çš„ã€‚æ¯”å¦‚è€ç‹æœ‰1000ä¸ªå¥½å‹ï¼Œé‚£ä¹ˆè€ç‹æ›´æ–°äº†å¤´åƒï¼Œé‚£ä¹ˆå°±è¦ç»™è¿™1000ä¸ªå¥½å‹å‘é€ä¸€æ¡é€šçŸ¥ä¿¡æ¯ï¼Œé€šçŸ¥ä»–çš„æ‰€æœ‰çš„å¥½å‹ï¼Œå“ï¼æ³¨æ„äº†ï¼Œèµ¶ç´§æ›´æ–°æˆ‘çš„æœ€æ–°ä¿¡æ¯ï¼Œæˆ‘å·²ç»æ›´æ–°ä¿¡æ¯äº†ï¼Œé‚£ä¹ˆ1000ä¸ªå¥½å‹å¾ˆå¤šéƒ½ä¸åœ¨çº¿ï¼Œä½ å‘äº†ä¹Ÿæ˜¯æµªè´¹æµé‡ï¼Œè€Œä¸”å¾ˆå¤šäººï¼Œå¯èƒ½æœ‰999ä¸ªäººæ˜¯ä¸å…³å¿ƒä½ æ›´ä¸æ›´æ–°å¤´åƒçš„å‘€ï¼è€ç‹ä½ çƒ¦ä¸çƒ¦ï¼Œè€æ˜¯æ›´æ–°å¤´åƒç»™æˆ‘å‘æ¶ˆæ¯ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸æ˜¯å¾ˆå¥½ã€‚
  ç¬¬äºŒä¸ªï¼Œæˆ‘è§‰å¾—ä»æ¶ˆæ¯å…¥æ‰‹ï¼Œä½ è€ç‹æ›´æ–°äº†å¤´åƒï¼Œä½ åªè¦ç»™æˆ‘å‘é€ä»»ä½•èŠå¤©æ¶ˆæ¯æˆ‘å°±èƒ½æ£€æµ‹åˆ°ä½ æ¢äº†å¤´åƒã€‚æ€ä¹ˆæ£€æµ‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥æ‹ä¸€æ‹è¿™ä¸ªé€»è¾‘ï¼Œé¦–å…ˆæ˜¯è€ç‹å’Œæˆ‘åœ¨èŠå¤©ï¼Œæ˜¾ç¤ºçš„æ˜¯ç°åœ¨çš„å¤´åƒï¼Œçªç„¶è€ç‹å»æ¢äº†å¤´åƒï¼Œå“ï¼Œæˆ‘ä¸çŸ¥é“å•Šï¼Œå¦‚æœæˆ‘ç»™è€ç‹å‘æ¶ˆæ¯ï¼Œè€ç‹ä¸ç†æˆ‘æˆ‘ï¼Œæˆ‘æ˜¯æ‹¿ä¸åˆ°è€ç‹çš„æ–°å¤´åƒçš„ï¼Œé‚£ä¹ˆä¸€æ—¦è€ç‹æœ‰å›å¤æˆ‘ï¼Œå°±æ˜¯è€ç‹æœ‰å‘ä¸€æ¡ä»»æ„ç±»å‹çš„æ¶ˆæ¯ï¼ˆæ¶ˆæ¯æœ‰å¾ˆå¤šç±»å‹ï¼Œè¯­éŸ³æ¶ˆæ¯ï¼Œå›¾ç‰‡æ¶ˆæ¯ï¼Œåœ°ç†ä½ç½®æ¶ˆæ¯ç­‰ï¼‰ï¼Œæˆ‘å°±ä»æ¶ˆæ¯ä¸­è·å¾—è€ç‹çš„ä¿¡æ¯ï¼Œä¿¡æ¯ä¸­åŒ…å«å¤´åƒå­—æ®µï¼Œé‚£ä¹ˆå°±å¯ä»¥æ¯”è¾ƒäº†ï¼Œå¦‚æœå¤´åƒçš„urlæ”¹å˜äº†ï¼Œé‚£ä¹ˆè¯´æ˜è€ç‹ä½ æ›´æ–°äº†å¤´åƒï¼Œæˆ‘æ£€æµ‹åˆ°äº†å°±é©¬ä¸Šåˆ·æ–°å¥½å‹çš„æœ€æ–°ä¿¡æ¯å¹¶æ”¾å…¨å±€æ•°ç»„ä¸­ï¼Œå¹¶æ›´æ–°èäº‘çš„ç¼“å­˜ï¼Œè¿™ä¸ªç¼“å­˜å¾ˆé‡è¦ï¼Œä¸æ›´æ–°ç¼“å­˜ä¸è¡Œï¼Œä¸æ›´æ–°ç¼“å­˜å°±ç­‰äºç™½åšäº†ï¼Œæ›´æ–°ç¼“å­˜çš„æ–¹æ³•æ˜¯ ` [[RCIM sharedRCIM] refreshUserInfoCache:theLastedInfo withUserId:userInfoDic[@"sendUsersId"]];`å“‡é ï¼è¿™ä¸ªæ–¹æ¡ˆå¥½ï¼Œè®©æ¯æ¡æ¶ˆæ¯å¸¦æœ‰å¯¹æ–¹çš„ä¿¡æ¯ï¼Œä¿¡æ¯æ˜¯ä¸ª`json`çš„å­—ç¬¦ä¸²ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥å ç”¨æµé‡çš„å¤§å°ï¼Œè€Œä¸”æ˜¯æœ€æ–°çš„ä¿¡æ¯ï¼Œä¸ç”¨ç»™ä¸èŠå¤©çš„å¥½å‹å‘é€é€šçŸ¥ä¿¡æ¯äº†ã€‚å¥½äº†ï¼Œçœ‹ä¸‹é¢ä»£ç ã€‚
æˆ‘ä»¬ç”¨KVCæ‹¿åˆ°è¿™ä¸ªé™„åŠ ä¿¡æ¯çš„å­—ç¬¦ä¸²ï¼Œæ˜¯ä¸ª`json`æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸€å®šè¦ç”¨`KVC`ï¼Œä¸ç„¶ä½ ç”¨.æ˜¯æ‹¿ä¸åˆ°çš„ã€‚`Xcode`åå°è°ƒè¯•ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°è¿™äº›å­—æ®µã€‚é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨è€ç‹å°†è¦å‘é€è¿˜æ²¡æœ‰å‘é€çš„æ–¹æ³•ä¸­å»å¯¹æ¶ˆæ¯åšå¤„ç†ï¼Œåšä»€ä¹ˆå¤„ç†ï¼Ÿå°±æ˜¯åŠ ä¸Šè€ç‹çš„æœ€æ–°çš„ä¿¡æ¯å•Šï¼æ¥çœ‹ä»£ç ï¼Œè€…æ–­ä»£ç æ˜¯èŠå¤©ç•Œé¢çš„ï¼Œä¸è¦ææ··æ·†äº†ï¼ˆé‡å†™`RCConversationViewController`è¿™ä¸ª`VC`é‡Œé¢çš„æ–¹æ³•ï¼‰
```Object-C
- (RCMessageContent *)willSendMessage:(RCMessageContent *)messageCotent{
    
    if ([RCIMClient sharedRCIMClient].currentUserInfo.userId) {//å¦‚æœç™»å½•äº†
        NSDictionary *jsonDic = @{@"sendUsersId":[RCIMClient sharedRCIMClient].currentUserInfo.userId,@"sendUsersName":self.userName,@"sendUsersPhoto":[UserInfoModel currentUserinfo].photo};
        NSError *parseError = nil;
        NSData *jsonData = [NSJSONSerialization dataWithJSONObject:jsonDic options:NSJSONWritingPrettyPrinted error:&parseError];

        NSString *jsonString = [[NSString alloc]initWithData:jsonData encoding:NSUTF8StringEncoding];
        
        if ([messageCotent isKindOfClass:[RCTextMessage class]]) {
            
            RCTextMessage *textMessage = (RCTextMessage*)messageCotent;
            
            textMessage.extra = jsonString;
            
        }else if ([messageCotent isKindOfClass:[RCVoiceMessage class]]) {
            
            RCVoiceMessage *voiceMessage = (RCVoiceMessage*)messageCotent;
            
            voiceMessage.extra = jsonString;
            
        }else if ([messageCotent isKindOfClass:[RCImageMessage class]]) {
            
            RCImageMessage *imageMessage = (RCImageMessage*)messageCotent;
            
            imageMessage.extra = jsonString;
            
        }

    }else{
        
    }
    
    return messageCotent;
}
```
ä»¥ä¸Šçš„ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯å‘é€æ¶ˆæ¯çš„å‰é¢ï¼Œè¿˜æ²¡å‘é€çš„æ—¶å€™ï¼ŒæŠŠè‡ªå·±ï¼ˆè¿™æ—¶å€™å°±æ˜¯è€ç‹è‡ªå·±ï¼‰çš„ä¿¡æ¯ï¼ŒåŒ…è£…æˆ`JSONDic`ï¼Œç„¶ååœ¨è½¬æˆ`NSString`ï¼Œèµ‹å€¼ç»™`extra`ï¼Œè¿™æ ·å¯¹æ–¹å°±å¯ä»¥æ‹¿åˆ°æˆ‘çš„ä¿¡æ¯äº†ï¼Œå°±å¯ä»¥çŸ¥é“æˆ‘çš„å¤´åƒæœ‰æ²¡æœ‰æ›´æ–°äº†ã€‚
    ä»¥ä¸‹çš„ä»£ç å°±æ˜¯è§£æ`JSON`çš„è¿‡ç¨‹ï¼Œå’Œä¸Šé¢äº¤ç›¸å‘¼åº”å•Šã€‚å¯¹ä¸å¯¹ï¼
    ```Object-C
    NSString *extraString = [[message valueForKey:@"content"] valueForKey:@"extra"];

    if (extraString) {
        NSData *jsonData = [extraString dataUsingEncoding:NSUTF8StringEncoding];
        NSError *err;
        if (jsonData) {
        æ‹¿åˆ°å­—ç¬¦ä¸²ï¼Œè½¬æ¢ç§°Dataï¼Œç„¶åè½¬æˆæˆ‘ä»¬ç»å¸¸ç”¨çš„å­—å…¸ã€‚
            NSDictionary *userInfoDic = [NSJSONSerialization JSONObjectWithData:jsonData
                                                                        options:NSJSONReadingMutableContainers
                                                                          error:&err];
            NSLog(@"FFFFF%@",userInfoDic);
            if (userInfoDic) {
            ç”¨RCDataManagerçš„APIç›´æ¥æ‹¿åˆ°å‘é€è€…è€ç‹çš„userInfoï¼Œç„¶åä¸‹é¢å°±æ˜¯æ¯”è¾ƒå¤´åƒçš„urlæ˜¯å¦ä¸€æ ·äº†ã€‚
                RCUserInfo *senderInfo = [[RCDataManager shareManager] currentUserInfoWithUserId:userInfoDic[@"sendUsersId"]];
                
                RCUserInfo *theLastedInfo = [[RCUserInfo alloc]initWithUserId:userInfoDic[@"sendUsersId"] name:userInfoDic[@"sendUsersName"] portrait:userInfoDic[@"sendUsersPhoto"] phone:senderInfo.phone addressInfo:senderInfo.addressInfo realName:senderInfo.realName];
                
                
                if ([userInfoDic[@"sendUsersPhoto"] isEqualToString:senderInfo.portraitUri]) {
                    
                }else{
                è¿™é‡Œæ›´æ–°å¥½å‹çš„æœ€æ–°åˆ—è¡¨
                    [[RCDataManager shareManager] syncFriendList:^(NSMutableArray *friends, BOOL isSuccess) {
                        if (isSuccess) {
                        è¿™é‡Œæ›´æ–°èäº‘ç¼“å­˜ï¼Œä¸æ›´æ–°ç¼“å­˜æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘å·²ç»å®éªŒè¿‡äº†
                            [[RCIM sharedRCIM] refreshUserInfoCache:theLastedInfo withUserId:userInfoDic[@"sendUsersId"]];
                            
                        }else{
                            [[RCDataManager shareManager] syncFriendList:^(NSMutableArray *friends, BOOL isSuccess) {
                                
                            }];
                        }
                    }];
                }
            }
            
            
        }
    }
    
   // JSONå­—å…¸å°±æ˜¯ä¸‹é¢çš„è¿™ä¸ªæ ·å­ï¼ŒiOSerçœ‹äº†å°±æ‡‚äº†
    //    {"sendUsersId":"85","sendUsersName":"å¿«ä¹","sendUsersPhoto":"http://weixintest.ihk.cn/ihkwx_upload/userPhoto/13632415461-1449631301776.jpg"}

    NSString *notTroubleStr = [TheUserDefaults objectForKey:@"setSpareTimeYES"];
ä¸‹é¢å¤„ç†çš„æ˜¯å‹¿æ‰°æ—¶æ®µï¼Œå°±æ˜¯ä½•æ—¶æœ‰å£°éŸ³ï¼Œä½•æ—¶æ²¡å£°éŸ³ï¼Œä½•æ—¶æœ‰éœ‡åŠ¨ï¼Œä½•æ—¶æ— éœ‡åŠ¨ï¼Œå¦‚æœappè®¾ç½®é‡Œé¢æ²¡ç”¨è¿™äº›è®¾ç½®é¡¹ï¼Œé‚£ä¹ˆè¯·å¿½ç•¥
    if ([notTroubleStr isEqualToString:@"setSpareTimeNO"]) {
        
        [self RemindSwitch];

    }else if ([notTroubleStr isEqualToString:@"setSpareTimeYES"]){
        
        NSString *timeDuring = [TheUserDefaults objectForKey:@"spareTimeStr"];//11ä½æ—¶é—´  21:00-09:00
        NSString *fromHourStr = [timeDuring substringToIndex:2];
        NSString *toHourStr   = [timeDuring substringWithRange:NSMakeRange(6,2)];
        NSInteger fromHour=0;
        NSInteger toHour =0;
        if ([fromHourStr hasPrefix:@"0"]) {
            fromHour = [[fromHourStr substringWithRange:NSMakeRange(1, 1)] integerValue];
        }else{
            fromHour = [fromHourStr integerValue];
        }
        
        if ([toHourStr hasPrefix:@"0"]) {
            toHour = [[toHourStr substringWithRange:NSMakeRange(1, 1)] integerValue];
        }else{
            toHour = [toHourStr integerValue];
        }
        NSLog(@"fromHour =%ld ,toHour = %ld",fromHour,toHour);
        NSString *nowString  = [MSUtil gethhmmss];//01:28:02
        nowString = [nowString substringToIndex:2];
        if ([nowString hasPrefix:@"0"]) {
            nowString = [nowString substringFromIndex:0];
        }else{
            
        }
        NSLog(@"%@",nowString);
//        NSDate *nowDate = [self getCustomDateWithHour:fromHour];

        if (fromHour>toHour) {//21ï¼ï¼9è·¨å¤©
            if ([nowString integerValue]>=fromHour||[nowString integerValue]<=toHour) {
                [RCIM sharedRCIM].disableMessageAlertSound = YES;//å…³é—­å£°éŸ³
                
            }else{
                [self RemindSwitch];
            }
        }else if(fromHour==toHour){//8--8ç›¸åŒ
            if ([nowString integerValue]==fromHour) {
                [RCIM sharedRCIM].disableMessageAlertSound = YES;//å…³é—­å£°éŸ³

            }else{
                [self RemindSwitch];
            }
        }else if(fromHour<toHour){//6----10å½“å¤©
            
            if ([nowString integerValue]>=fromHour&&[nowString integerValue]<=toHour) {
                [RCIM sharedRCIM].disableMessageAlertSound = YES;//å…³é—­å£°éŸ³

            }else{
                [self RemindSwitch];
            }
        }
    }
    
    if (![[RCDataManager shareManager] hasTheFriendWithUserId:message.senderUserId]) {
        //æ£€æŸ¥message.senderUserIdè¿™ä¸ªäººåœ¨ä¸åœ¨æˆ‘å¥½å‹é‡Œé¢ï¼Œå¦‚æœæ²¡æœ‰åœ¨ï¼Œæµ‹ç½‘ç»œåˆ·æ–°æœ€æ–°çš„å¥½å‹åˆ—è¡¨
        [[RCDataManager shareManager] syncFriendList:^(NSMutableArray *friends,BOOL isSuccess) {
            [[RCDataManager shareManager] getUserInfoWithUserId:message.senderUserId completion:^(RCUserInfo *userInfo) {
                NSLog(@"åå­— ï¼ %@  ID ï¼ %@",userInfo.name,userInfo.userId);
            }];
        }];
    }
    [[RCDataManager shareManager] getUserInfoWithUserId:message.senderUserId completion:^(RCUserInfo *userInfo) {
        NSLog(@"åå­— ï¼ %@  ID ï¼ %@",userInfo.name,userInfo.userId);
    }];
    [self setDisplayConversationTypeArray:@[@(ConversationType_PRIVATE)]];
    [self refreshConversationTableViewIfNeeded];
    [[RCDataManager shareManager] refreshBadgeValue];
}

- (void)RemindSwitch {
    
    NSString *setShake = [TheUserDefaults objectForKey:@"setShakeYES"];
    NSString *setSound=[[NSUserDefaults standardUserDefaults]objectForKey:@"setSoundYES"];

    if (setShake && [setShake isEqualToString:@"setShakeYES"]) {
        AudioServicesPlayAlertSound(kSystemSoundID_Vibrate);//éœ‡åŠ¨
    }
    
    if(setSound && [setSound isEqualToString:@"setSoundYES"])
    {//æœ‰å£°éŸ³ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è®¾ç½®èäº‘æ¥æ”¶æ¶ˆæ¯æ—¶å€™çš„å£°éŸ³çš„æœ‰å’Œæ— 
        [RCIM sharedRCIM].disableMessageAlertSound = NO;
    }
    else{//æ— å£°éŸ³
        [RCIM sharedRCIM].disableMessageAlertSound = YES;
    }
}
#pragma mark - RCIMConnectionStatusDelegate
//è¿™ä¸ªæ˜¯æ£€æµ‹è¿æ¥connectçŠ¶æ€çš„ä»£ç†ï¼Œè¸¢äººçš„åŠŸèƒ½å¯ä»¥åšåœ¨è¿™é‡Œï¼Œé€»è¾‘æ˜¯ï¼Œstaueï¼ConnectionStatus_KICKED_OFFLINE_BY_OTHER_CLIENTï¼Œå°±æ˜¯è¢«Täº†ï¼Œç„¶åå¼¹å‡ºæç¤ºæ¡†ï¼Œæç¤ºç”¨æˆ·â€œæ‚¨çš„å¸å·å·²åœ¨åˆ«çš„è®¾å¤‡ä¸Šç™»å½•ï¼Œ\næ‚¨è¢«è¿«ä¸‹çº¿ï¼â€ï¼Œç„¶åç‚¹å‡»ç¡®å®šå°±è¦è°ƒç”¨ç™»å‡ºçš„æ¥å£ï¼Œå¤„ç†ç™»å‡ºçš„é€»è¾‘äº†ï¼Œæ¯ä½å¼€å‘è€…è‡ªå·±å¤„ç†ç™»å‡ºçš„é€»è¾‘ï¼Œç™»å‡ºçš„é€»è¾‘å¯ä»¥å•ç‹¬æŠ½ç¦»å‡ºæ¥ã€‚
/**
 *  ç½‘ç»œçŠ¶æ€å˜åŒ–ã€‚
 *  @param status ç½‘ç»œçŠ¶æ€ã€‚
 */
- (void)onRCIMConnectionStatusChanged:(RCConnectionStatus)status {
    NSLog(@"RCConnectionStatus = %ld",(long)status);
    if (status == ConnectionStatus_KICKED_OFFLINE_BY_OTHER_CLIENT) {
        UIAlertView *alert = [[UIAlertView alloc]
                              initWithTitle:nil
                              message:@"æ‚¨çš„å¸å·å·²åœ¨åˆ«çš„è®¾å¤‡ä¸Šç™»å½•ï¼Œ\næ‚¨è¢«è¿«ä¸‹çº¿ï¼"
                              delegate:self
                              cancelButtonTitle:@"çŸ¥é“äº†"
                              otherButtonTitles:nil, nil];
        [alert show];
    }
}

-(id)initWithCoder:(NSCoder *)aDecoder{
    self =[super initWithCoder:aDecoder];
    if (self) {
        //è®¾ç½®è¦æ˜¾ç¤ºçš„ä¼šè¯ç±»å‹
        [self setDisplayConversationTypes:@[@(ConversationType_PRIVATE)]];
         [self setConversationAvatarStyle:1];
    }
    return self;
}
-(void)callSpecialAgent:(UITapGestureRecognizer *)sender{
    if (firstShowView) {
        [firstShowView removeFromSuperview];
        firstShowView = nil;
        
    }
    SpecialAgentViewController *saVC = [[SpecialAgentViewController alloc]init];
    [self.navigationController pushViewController:saVC animated:YES];
}
#pragma mark 
#pragma mark  viewDidLoad
- (void)viewDidLoad {
    [super viewDidLoad];
    self.edgesForExtendedLayout = UIRectEdgeNone;
    self.view.backgroundColor = [UIColor whiteColor];
    //è®¾ç½®title
    UIView *netWorkView = (UIView *)self.networkIndicatorView;
    netWorkView.frame = CGRectZero;
    netWorkView.hidden = YES;
    [netWorkView removeFromSuperview];
    self.navigationItem.title=KTitle_isShowAllSame?KTitle_SameStr: @"åˆè®°ä¹°æ¥¼";

    //å¸ƒå±€
    UIImage *headerImage = [UIImage imageNamed:@"hjtgdk.jpg"];
    CGFloat radi = headerImage.size.width/headerImage.size.height;
    headerIV =[[UIImageView  alloc]initWithFrame:CGRectMake(0, 0, self.conversationListTableView.frame.size.width, self.conversationListTableView.frame.size.width/(radi))];
    headerIV.userInteractionEnabled = YES;
    headerIV.image = headerImage;
    NSLog(@"%@",self.conversationListTableView);
    NSLog(@"%@",headerIV);
    [self.view addSubview:headerIV];
    self.conversationListTableView.frame = CGRectMake(self.conversationListTableView.frame.origin.x, headerIV.frame.origin.y+headerIV.frame.size.height, self.conversationListTableView.frame.size.width, self.conversationListTableView.frame.size.height-headerIV.frame.size.height);
    self.conversationListTableView.rowHeight = kCellHeight;
    self.conversationListTableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;
    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(callSpecialAgent:)];
    [headerIV addGestureRecognizer:tap];
    //è®¾ç½®tableViewæ ·å¼
    self.conversationListTableView.backgroundColor = [MSUtil colorWithHexString:@"#e5e5e5"];
//    self.conversationListTableView.backgroundColor = [UIColor whiteColor];
    self.conversationListTableView.separatorStyle = UITableViewCellSeparatorStyleNone;
    
    
    if ([RCIM sharedRCIM].currentUserInfo.userId) {
        if (self.conversationListDataSource.count==0) {
            self.conversationListTableView.tableFooterView = [UIView new];
        }else{
            UIView *afooter = [[UIView alloc]initWithFrame:CGRectMake(0, 0, self.conversationListTableView.frame.size.width, 0.5)];
            afooter.backgroundColor = [UIColor lightGrayColor];
            self.conversationListTableView.tableFooterView = afooter;
        }
    }else{
        self.conversationListTableView.tableFooterView = [UIView new];
    }
    if ([TheUserDefaults boolForKey:@"everShow"]==NO) {
        firstShowView = [[UIView alloc]initWithFrame:CGRectMake(0, 0, kScreenWidth, kScreenHeight-kNavbarHeight-kTabBarHeight)];
        firstShowView.backgroundColor = [UIColor colorWithWhite:0.2 alpha:0.95];
        [self.view addSubview:firstShowView];
        [self.view bringSubviewToFront:firstShowView];
        [TheUserDefaults setBool:YES forKey:@"everShow"];
        [TheUserDefaults synchronize];
       
        
        UIImage *image = [UIImage imageNamed:@"hjtgdc"];
        float radio = image.size.width/image.size.height;
        UIImageView *centerIV = [[UIImageView alloc]initWithFrame:CGRectMake(0, firstShowView.frame.size.height-((kScreenWidth-2*30)/radio)/2, kScreenWidth-2*30, (kScreenWidth-2*30)/radio)];
        centerIV.image = image;
        centerIV.userInteractionEnabled = YES;
        centerIV.center = firstShowView.center;
        [firstShowView addSubview:centerIV];
        UIButton *Xbtn = [UIButton buttonWithType:UIButtonTypeCustom];
        Xbtn.frame = CGRectMake(centerIV.frame.size.width-50+5, -5, 50, 50);
        [Xbtn setImage:[UIImage imageNamed:@"chatDelete"] forState:UIControlStateNormal];
        [Xbtn setImage:[UIImage imageNamed:@"chatDelete"] forState:UIControlStateSelected];
        [Xbtn addTarget:self action:@selector(removeShowView:) forControlEvents:UIControlEventTouchUpInside];
        [centerIV addSubview:Xbtn];
        [centerIV bringSubviewToFront:Xbtn];
        UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(callSpecialAgent:)];
        [centerIV addGestureRecognizer:tap];
    }
}
-(void)removeShowView:(UIButton *)sender{
    if (firstShowView) {
        [firstShowView removeFromSuperview];
        firstShowView = nil;
    }
    [self showEmptyConversationView];
}
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    [[UIApplication sharedApplication]setStatusBarStyle:UIStatusBarStyleLightContent];
    [self.navigationController.navigationBar wm_setBackgroundColor:kColor_Theme];
    [self refreshConversationTableViewIfNeeded];
    [self resetConversationListBackgroundViewIfNeeded];
    if ([RCIMClient sharedRCIMClient].currentUserInfo.userId) {//ç™»å½•
        [[RCDataManager shareManager] refreshBadgeValue];
        [self setDisplayConversationTypeArray:@[@(ConversationType_PRIVATE)]];
        
        aIV.hidden = NO;
        aLabel.hidden = NO;
        [bgView sendSubviewToBack:aIV];
        [bgView sendSubviewToBack:aLabel];
        [hud removeFromSuperview];
    }else{//æ²¡ç™»å½•
        BaseNavigationController  *chatNav =[AppDelegate shareAppDelegate].rootTabbar.viewControllers[2];
        chatNav.tabBarItem.badgeValue = nil;
        [self setDisplayConversationTypeArray:nil];
        
        
        if (self.conversationListDataSource.count) {//å·²ç™»å‡ºï¼Œæœ‰æ•°æ®
//            [hud show:YES];
            aIV.hidden = YES;
            aLabel.hidden = YES;
            [bgView sendSubviewToBack:aIV];
            [bgView sendSubviewToBack:aLabel];
            [hud removeFromSuperview];

        }else{//å·²ç™»å‡ºï¼Œæ²¡æ•°æ®
            [hud show:NO];
            aIV.hidden = NO;
            aLabel.hidden = NO;
            [hud removeFromSuperview];
        }
        
        dispatch_async(dispatch_get_main_queue(), ^{
            [self refreshConversationTableViewIfNeeded];
            [self showEmptyConversationView];
        });
    }
    [self showEmptyConversationView];

}
-(void)removeLoginHud:(NSNotification *)obj{
    NSLog(@"æ”¶åˆ°é€šçŸ¥");
    if (hud) {
        dispatch_async(dispatch_get_main_queue(), ^{
           
            [self setDisplayConversationTypeArray:@[@(ConversationType_PRIVATE)]];

            [self performSelector:@selector(refershTable) withObject:nil afterDelay:0.5];
        });
        
    }
}
-(void)refershTable{
    dispatch_async(dispatch_get_main_queue(), ^{
        [self.conversationListTableView reloadData];
        [self performSelector:@selector(refershTableIfNeeded) withObject:nil afterDelay:0.5];
    });
}
-(void)refershTableIfNeeded{
    [hud hide:YES];
    [hud removeFromSuperview];
    aIV.hidden  = NO;
    aLabel.hidden = NO;
    dispatch_async(dispatch_get_main_queue(), ^{
        [self refreshConversationTableViewIfNeeded];
        [self showEmptyConversationView];
    });
    
}
-(void)viewWillDisappear:(BOOL)animated{
    [super viewWillDisappear:animated];
    //show
    self.navigationItem.title = @"";
}

#pragma mark override
//é€šçŸ¥æ›´æ–°æœªè¯»æ¶ˆæ¯æ•°ç›®ï¼Œç”¨äºæ˜¾ç¤ºæœªè¯»æ¶ˆæ¯ï¼Œå½“æ”¶åˆ°ä¼šè¯æ¶ˆæ¯çš„æ—¶å€™ï¼Œä¼šè§¦å‘ä¸€æ¬¡ã€‚
- (void)notifyUpdateUnreadMessageCount{
    [[RCDataManager shareManager] refreshBadgeValue];
}
-(void)loginorRegister:(UIButton *)sender{
    [self.navigationController pushViewController:[LoginViewController new] animated:YES];
}
//é‡å†™æ–¹æ³•ï¼Œè®¾ç½®ä¼šè¯åˆ—è¡¨emptyConversationViewçš„è§†å›¾ã€‚//æ— èŠå¤©cellçš„æ—¶å€™ä¸€èˆ¬ä¼šæ˜¾ç¤ºä¸€ä¸ªé»˜è®¤çš„å›¾ç‰‡æˆ–è€…åŠ ä¸€äº›buttonæˆ–è€…ä¸€äº›imageViewå•Šç­‰ç­‰ï¼Œé‚£ä¹ˆé€»è¾‘å°±æ˜¯åœ¨ä¸‹é¢çš„è¿™ä¸ªæ–¹æ³•ä¸­å¤„ç†ï¼Œæˆ‘çš„æ–¹æ³•å¯èƒ½ä¸æ˜¯æœ€å¥½çš„ï¼Œå¦‚æœæœ‰åŒå­¦æœ‰å¥½æ–¹æ³•æ¬¢è¿æ‰¾æˆ‘äº¤æµï¼ŒåŠ æˆ‘çš„iOSæŠ€æœ¯äº¤æµç¾¤487599875ï¼Œè°¢è°¢ã€‚
- (void)showEmptyConversationView{
    UsersType type = [MSUtil checkUserType];
    
    if (firstShowView) {
        return;
    }
    if (bgView==nil) {
      UIImage *  nochatDataImage = [UIImage imageNamed:@"nochatData"];
        bgView = [[UIView alloc]initWithFrame:CGRectMake(0, (kScreenHeight-kNavbarHeight-headerIV.frame.size.height-kTabBarHeight)/2-nochatDataImage.size.height/2, kScreenWidth, nochatDataImage.size.height+kNavbarHeight)];
        bgView.hidden  = NO;
        bgView.center = self.conversationListTableView.center;
        aIV = [[UIImageView alloc]initWithFrame:CGRectMake(kScreenWidth/2-nochatDataImage.size.width/2, 0, nochatDataImage.size.width, nochatDataImage.size.height)];
        aIV.image = nochatDataImage;
        [bgView addSubview:aIV];
        
        aLabel = [[UILabel alloc]initWithFrame:CGRectMake(0, aIV.frame.origin.y+aIV.frame.size.height, bgView.frame.size.width, kNavbarHeight)];
        aLabel.text = @"æš‚æ— èŠå¤©æ•°æ®";
        aLabel.textColor = kFontColor_999999;
        aLabel.textAlignment = NSTextAlignmentCenter;
        [bgView addSubview:aLabel];
      
//        UserInfoModel *userinfo = [UserInfoModel currentUserinfo];
//
//        if (userinfo.login==YES&&![userinfo.userId isEqualToString:@""]&&![RCIMClient sharedRCIMClient].currentUserInfo.userId) {
//            
//            aIV.hidden = YES;
//            aLabel.hidden = YES;
//            
//        }else{
//            aIV.hidden = NO;
//            aLabel.hidden = NO;
//        }
        
        
        
        
        
    }
    
    
    if ([RCIM sharedRCIM].currentUserInfo.userId) {//ç™»å½•äº†
        if (type==UsersTypeYouke) {

        }else if (type==UsersTypeCustomer){
            self.emptyConversationView = bgView;
            if (self.conversationListDataSource.count) {//æœ‰æ•°æ®
                
            }else{//æ²¡æ•°æ®
                self.emptyConversationView = bgView;
                
                [hud show:NO];
                aIV.hidden = NO;
                aLabel.hidden = NO;
                [hud removeFromSuperview];
            }
            
            
        }else if (type==UsersTypeSales){

            if (self.conversationListDataSource.count) {//æœ‰æ•°æ®

                
            }else{//æ²¡æ•°æ®
                self.emptyConversationView = bgView;
                
                [hud show:NO];
                aIV.hidden = NO;
                aLabel.hidden = NO;
                [hud removeFromSuperview];
            }
            
            self.emptyConversationView = bgView;
        }

    }else{//æ²¡ç™»å½•
        self.emptyConversationView = bgView;
        if (self.conversationListDataSource.count) {//å·²ç™»å‡ºï¼Œæœ‰æ•°æ®
            aIV.hidden = YES;
            aLabel.hidden = YES;
            [bgView sendSubviewToBack:aIV];
            [bgView sendSubviewToBack:aLabel];
            [self.view bringSubviewToFront:self.conversationListTableView];
            [hud removeFromSuperview];
            
        }else{//å·²ç™»å‡ºï¼Œæ²¡æ•°æ®
             self.emptyConversationView = bgView;

            [hud show:NO];
            aIV.hidden = NO;
            aLabel.hidden = NO;
            [bgView bringSubviewToFront:aIV];
            [bgView bringSubviewToFront:aLabel];
            [hud removeFromSuperview];
        }

    }
    
    if ([self.view.subviews containsObject:bgView]) {
        
    }else{
        [self.view addSubview:self.emptyConversationView];
    }
//
}

//*********************æ’å…¥è‡ªå®šä¹‰Cell*********************//

//æ’å…¥è‡ªå®šä¹‰ä¼šè¯model
-(NSMutableArray *)willReloadTableData:(NSMutableArray *)dataSource{
    for (int i=0; i<dataSource.count; i++) {
        RCConversationModel *model = dataSource[i];
        if(model.conversationType == ConversationType_PRIVATE){
            model.conversationModelType = RC_CONVERSATION_MODEL_TYPE_CUSTOMIZATION;
        }
    }
    return dataSource;
}
#pragma mark
#pragma mark onSelectedTableRow
- (void)onSelectedTableRow:(RCConversationModelType)conversationModelType
         conversationModel:(RCConversationModel *)model
               atIndexPath:(NSIndexPath *)indexPath{
    ConversationViewController *_conversationVC = [[ConversationViewController alloc]init];
    _conversationVC.conversationType = model.conversationType;
    _conversationVC.targetId = model.targetId;
    for (RCUserInfo *userInfo in [AppDelegate shareAppDelegate].friendsArray) {
        if ([model.targetId isEqualToString:userInfo.userId]) {
            _conversationVC.userName = userInfo.name;
            _conversationVC.title =[userInfo.realName isEqualToString:@""]?[NSString stringWithFormat:@"%@",userInfo.name]:[NSString stringWithFormat:@"%@",userInfo.realName];
        }
    }
    [self.navigationController pushViewController:_conversationVC animated:YES];
}
#pragma mark
#pragma mark ç¦æ­¢å³æ»‘åˆ é™¤
-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath{
    return YES;
}
//å·¦æ»‘åˆ é™¤
-(void)rcConversationListTableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath{
    //å¯ä»¥ä»æ•°æ®åº“åˆ é™¤æ•°æ®
    if (indexPath.row < self.conversationListDataSource.count) {
    RCConversationModel *model = self.conversationListDataSource[indexPath.row];
    [[RCIMClient sharedRCIMClient] removeConversation:ConversationType_PRIVATE targetId:model.targetId];
    [self.conversationListDataSource removeObjectAtIndex:indexPath.row];
    [self.conversationListTableView reloadData];
    [[RCDataManager shareManager] refreshBadgeValue];
    }
}
//é«˜åº¦
-(CGFloat)rcConversationListTableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{
    return kCellHeight;
}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
    
    if ([UserInfoModel currentUserinfo].pushToken.length > 0 && [UserInfoModel currentUserinfo].userEncrypt.length > 0) {
        
        [Networking logout:^(NetworkModel *model) {
            
            if ([[NSString stringWithFormat:@"%@",model.result]isEqualToString:@"10000"]) {
                [UserInfoModel logoutUserinfo];
                
                BaseNavigationController  *chatNav = [AppDelegate shareAppDelegate].rootTabbar.viewControllers[2];
                chatNav.tabBarItem.badgeValue = nil;
                [UIApplication sharedApplication].applicationIconBadgeNumber = 0;
                
                [[RCIMClient sharedRCIMClient] clearConversations:@[@(ConversationType_PRIVATE)]];
                [[RCIMClient sharedRCIMClient] disconnect:NO];

                BaseNavigationController *baseVC = (BaseNavigationController *)[AppDelegate shareAppDelegate].rootTabbar.selectedViewController;
                [baseVC pushViewController:[[LoginViewController alloc]init] animated:YES];
            }
            else {
                [MSUtil showTipsWithHUD:model.msg inView:self.view];
            }
            
        } fail:^(NSError *error) {
            [MSUtil showTipsWithHUD:kTips_NetworkError inView:self.view];
        }];
    }
}

-(void)willDisplayConversationTableCell:(RCConversationBaseCell *)cell atIndexPath:(NSIndexPath *)indexPath{
    if ([cell isMemberOfClass:[RCCustomCell  class]]) {
        RCCustomCell *conversationCell = (RCCustomCell *)cell;
//        conversationCell.conversationTitle.text=@"";
        
        RCConversationModel *model = self.conversationListDataSource[indexPath.row];
//        conversationCell.conversationTitle.text = [[RCDataManager shareManager] currentNameWithUserId:model.targetId];
//        if (model) {
//            if (model.targetId) {
//                if ([[AppDelegate shareAppDelegate].friendsArray containsObject:[[RCDataManager shareManager] currentUserInfoWithUserId:model.targetId]]) {
//                    [[RCIM sharedRCIM] refreshUserInfoCache:[[RCDataManager shareManager] currentUserInfoWithUserId:model.targetId] withUserId:model.targetId];
//
//                }
//            }
//        }
        
        for (RCUserInfo *userInfo in [AppDelegate shareAppDelegate].friendsArray) {
            if ([model.targetId isEqualToString:userInfo.userId]) {
                NSDictionary *attributeDic = [NSDictionary dictionaryWithObjectsAndKeys:[UIFont systemFontOfSize:18], NSFontAttributeName, nil];
                CGSize nameLabelSize = [userInfo.realName boundingRectWithSize:CGSizeMake(MAXFLOAT, conversationCell.realNameLabel.frame.size.height) options:NSStringDrawingUsesLineFragmentOrigin attributes:attributeDic context:nil].size;
                conversationCell.realNameLabel.frame = CGRectMake(conversationCell.realNameLabel.frame.origin.x, conversationCell.realNameLabel.frame.origin.y, nameLabelSize.width, conversationCell.realNameLabel.frame.size.height);
                conversationCell.typeNameLabel.frame = CGRectMake(conversationCell.realNameLabel.frame.origin.x+conversationCell.realNameLabel.frame.size.width+10, conversationCell.realNameLabel.frame.origin.y, conversationCell.typeNameLabel.frame.size.width, conversationCell.realNameLabel.frame.size.height);
                if (indexPath.row==self.conversationListDataSource.count-1) {
                    conversationCell.seprateLine.hidden = YES;
                }else{
                    conversationCell.seprateLine.hidden = NO;
                }
            }
        }
        
        
    }
}
//*********************æ’å…¥è‡ªå®šä¹‰Cell*********************//

-(RCConversationBaseCell *)rcConversationListTableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    if (self.conversationListDataSource.count&&indexPath.row < self.conversationListDataSource.count) {
        RCConversationModel *model = self.conversationListDataSource[indexPath.row];
        [[RCDataManager shareManager] getUserInfoWithUserId:model.targetId completion:^(RCUserInfo *userInfo) {
            NSLog(@"rcConversationListTableView åå­— ï¼ %@  ID ï¼ %@",userInfo.name,userInfo.userId);
        }];
        NSInteger unreadCount = model.unreadMessageCount;
        RCCustomCell *cell = (RCCustomCell *)[[RCCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"RCCustomCell"];
       
        
        NSDate *date = [NSDate dateWithTimeIntervalSince1970:model.receivedTime/1000];
        NSString *timeString = [[MSUtil stringFromDate:date] substringToIndex:10];
        NSString *temp = [MSUtil getyyyymmdd];
        NSString *nowDateString = [NSString stringWithFormat:@"%@-%@-%@",[temp substringToIndex:4],[temp substringWithRange:NSMakeRange(4, 2)],[temp substringWithRange:NSMakeRange(6, 2)]];
        
        if ([timeString isEqualToString:nowDateString]) {
            NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
            [formatter setDateFormat:@"HH:mm"];
            NSString *showtimeNew = [formatter stringFromDate:date];
            cell.timeLabel.text = [NSString stringWithFormat:@"%@",showtimeNew];

        }else{
            cell.timeLabel.text = [NSString stringWithFormat:@"%@",timeString];
        }
        cell.ppBadgeView.dragdropCompletion = ^{
                    NSLog(@"VC = FFF ï¼ŒID ï¼ %@",model.targetId);
            
            
            
           
            
            [[RCIMClient sharedRCIMClient] clearMessagesUnreadStatus:ConversationType_PRIVATE targetId:model.targetId];
            model.unreadMessageCount = 0;
            NSInteger ToatalunreadMsgCount = (NSInteger)[[RCIMClient sharedRCIMClient] getUnreadCount:@[@(ConversationType_PRIVATE)]];
            
            long tabBarCount = ToatalunreadMsgCount-model.unreadMessageCount;
            int notReadMessage = [[UserInfoModel currentUserinfo].notReadMessage intValue];
            
            if (tabBarCount > 0) {
                [AppDelegate shareAppDelegate].rootTabbar.selectedViewController.tabBarItem.badgeValue = [NSString stringWithFormat:@"%ld",tabBarCount];
                
                if (notReadMessage > 0) {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = notReadMessage + tabBarCount;
                }
                else {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = tabBarCount;
                }
            }
            else {
                [AppDelegate shareAppDelegate].rootTabbar.selectedViewController.tabBarItem.badgeValue = nil;
                
                if (notReadMessage > 0) {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = notReadMessage;
                }
                else {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;
                }
            }
        };
        if (unreadCount==0) {
            cell.ppBadgeView.text = @"";
        
        }else{
            if (unreadCount>=100) {
                cell.ppBadgeView.text = @"99+";
            }else{
                cell.ppBadgeView.text = [NSString stringWithFormat:@"%li",(long)unreadCount];

            }
        }

        

        for (RCUserInfo *userInfo in [AppDelegate shareAppDelegate].friendsArray) {
            if ([model.targetId isEqualToString:userInfo.userId]) {
                
                cell.realNameLabel.text = [userInfo.realName isEqualToString:@""]?[NSString stringWithFormat:@"%@",userInfo.name]:[NSString stringWithFormat:@"%@",userInfo.realName];
                
                
                UsersType type = [MSUtil checkUserType];
                
              
                
                
                if (type==UsersTypeYouke) {
                    
                }else if (type==UsersTypeCustomer){
                    cell.typeNameLabel.text = @"ä¸“å®¶";

                }else if (type==UsersTypeSales){
                    cell.typeNameLabel.text = @"å®¢æˆ·";
                    cell.typeNameLabel.textColor = kFontColor_999999;
                }

                if ([userInfo.portraitUri isEqualToString:@""]||userInfo.portraitUri==nil) {
                    cell.avatarIV.image = [UIImage imageNamed:@"chatlistDefault"];
                    [cell.contentView bringSubviewToFront:cell.avatarIV];
                }else{
                    [cell.avatarIV sd_setImageWithURL:[NSURL URLWithString:userInfo.portraitUri] placeholderImage:[UIImage imageNamed:@"chatlistDefault"]];
                }
                
                if ([model.lastestMessage isKindOfClass:[RCTextMessage class]]) {
                    cell.contentLabel.text = [model.lastestMessage valueForKey:@"content"];
                    
                }else if ([model.lastestMessage isKindOfClass:[RCImageMessage class]]){
                    
                    if ([model.senderUserId isEqualToString:[RCIMClient sharedRCIMClient].currentUserInfo.userId]) {
                        //æˆ‘è‡ªå·±å‘çš„
                        RCUserInfo *myselfInfo = [RCIMClient sharedRCIMClient].currentUserInfo;
                        
                        if ([[NSString stringWithFormat:@"%@",myselfInfo.realName] isEqualToString:@""]) {
                            cell.contentLabel.text =[NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„å›¾ç‰‡æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.name];
                        }else{
                            cell.contentLabel.text =[NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„å›¾ç‰‡æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.realName];
                            
                        }
                    }else{
                        
                        cell.contentLabel.text =[NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„å›¾ç‰‡æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",userInfo.realName] ;
                    }
                    
                }else if ([model.lastestMessage isKindOfClass:[RCVoiceMessage class]]){
                    if ([model.senderUserId isEqualToString:[RCIMClient sharedRCIMClient].currentUserInfo.userId]) {
                        //æˆ‘è‡ªå·±å‘çš„
                        RCUserInfo *myselfInfo = [RCIMClient sharedRCIMClient].currentUserInfo;
                        if ([[NSString stringWithFormat:@"%@",myselfInfo.realName] isEqualToString:@""]) {
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„è¯­éŸ³æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.name];
                            
                        }else{
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„è¯­éŸ³æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.realName];
                        }
                    }else{
                        cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„è¯­éŸ³æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",userInfo.realName];
                    }
                }
                else if ([model.lastestMessage isKindOfClass:[RCLocationMessage class]]){
                    if ([model.senderUserId isEqualToString:[RCIMClient sharedRCIMClient].currentUserInfo.userId]) {
                        //æˆ‘è‡ªå·±å‘çš„
                        RCUserInfo *myselfInfo = [RCIMClient sharedRCIMClient].currentUserInfo;
                        if ([[NSString stringWithFormat:@"%@",myselfInfo.realName] isEqualToString:@""]) {
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„ä½ç½®æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.name];
                        }else{
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„ä½ç½®æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.realName];
                        }
                    }else{
                        cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„ä½ç½®æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",userInfo.realName];
                    }
                }
                
            }
        }
        
        return cell;
    }
    else{
        
        return [[RCConversationBaseCell alloc]init];
    }
    
    
}
- (void)didSendMessage:(NSInteger)stauts content:(RCMessageContent *)messageCotent{
    NSLog(@"fffff %@",messageCotent);
    
}
-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    
  return  self.conversationListDataSource.count;
}

#pragma mark - æ”¶åˆ°æ¶ˆæ¯ç›‘å¬
-(void)didReceiveMessageNotification:(NSNotification *)notification{
    __weak typeof(&*self) blockSelf_ = self;
    //å¤„ç†å¥½å‹è¯·æ±‚
    RCMessage *message = notification.object;

    if ([message.content isMemberOfClass:[RCMessageContent class]]) {
        if (message.conversationType == ConversationType_PRIVATE) {
            NSLog(@"å¥½å‹æ¶ˆæ¯è¦å‘ç³»ç»Ÿæ¶ˆæ¯ï¼ï¼ï¼");
            @throw  [[NSException alloc] initWithName:@"error" reason:@"å¥½å‹æ¶ˆæ¯è¦å‘ç³»ç»Ÿæ¶ˆæ¯ï¼ï¼ï¼" userInfo:nil];
        }
        RCConversationModel *customModel = [RCConversationModel new];
        //è‡ªå®šä¹‰cellçš„type
        customModel.conversationModelType = RC_CONVERSATION_MODEL_TYPE_CUSTOMIZATION;
        customModel.senderUserId = message.senderUserId;
        customModel.lastestMessage = message.content;
        dispatch_async(dispatch_get_main_queue(), ^{
            //è°ƒç”¨çˆ¶ç±»åˆ·æ–°æœªè¯»æ¶ˆæ¯æ•°
            [blockSelf_ refreshConversationTableViewWithConversationModel:customModel];
            [super didReceiveMessageNotification:notification];
            [blockSelf_ resetConversationListBackgroundViewIfNeeded];
            [self notifyUpdateUnreadMessageCount];
            
            //å½“æ¶ˆæ¯ä¸ºRCContactNotificationMessageæ—¶ï¼Œæ²¡æœ‰è°ƒç”¨superï¼Œå¦‚æœæ˜¯æœ€åä¸€æ¡æ¶ˆæ¯ï¼Œå¯èƒ½éœ€è¦åˆ·æ–°ä¸€ä¸‹æ•´ä¸ªåˆ—è¡¨ã€‚
            //åŸå› è¯·æŸ¥çœ‹super didReceiveMessageNotificationçš„æ³¨é‡Šã€‚
            
        });
        
    }else if (message.conversationType == ConversationType_PRIVATE){
        //è·å–æ¥å—åˆ°ä¼šè¯
        RCConversation *receivedConversation = [[RCIMClient sharedRCIMClient] getConversation:message.conversationType targetId:message.targetId];
        
        //è½¬æ¢æ–°ä¼šè¯ä¸ºæ–°ä¼šè¯æ¨¡å‹
        RCConversationModel *customModel = [[RCConversationModel alloc] init:RC_CONVERSATION_MODEL_TYPE_CUSTOMIZATION conversation:receivedConversation extend:nil];
        dispatch_async(dispatch_get_main_queue(), ^{
            //è°ƒç”¨çˆ¶ç±»åˆ·æ–°æœªè¯»æ¶ˆæ¯æ•°
            [blockSelf_ refreshConversationTableViewWithConversationModel:customModel];
            //[super didReceiveMessageNotification:notification];
            [blockSelf_ resetConversationListBackgroundViewIfNeeded];
            [self notifyUpdateUnreadMessageCount];
            
            //å½“æ¶ˆæ¯ä¸ºRCContactNotificationMessageæ—¶ï¼Œæ²¡æœ‰è°ƒç”¨superï¼Œå¦‚æœæ˜¯æœ€åä¸€æ¡æ¶ˆæ¯ï¼Œå¯èƒ½éœ€è¦åˆ·æ–°ä¸€ä¸‹æ•´ä¸ªåˆ—è¡¨ã€‚
            //åŸå› è¯·æŸ¥çœ‹super didReceiveMessageNotificationçš„æ³¨é‡Šã€‚
            NSNumber *left = [notification.userInfo objectForKey:@"left"];
            if (0 == left.integerValue) {
                [super refreshConversationTableViewIfNeeded];
            }
        });
    } else {
        dispatch_async(dispatch_get_main_queue(), ^{
            //            è°ƒç”¨çˆ¶ç±»åˆ·æ–°æœªè¯»æ¶ˆæ¯æ•°
            [super didReceiveMessageNotification:notification];
            [blockSelf_ resetConversationListBackgroundViewIfNeeded];
            [self notifyUpdateUnreadMessageCount];
            
            //        superä¼šè°ƒç”¨notifyUpdateUnreadMessageCount
        });
    }
    [[RCDataManager shareManager] getUserInfoWithUserId:message.senderUserId completion:^(RCUserInfo *userInfo) {
        NSLog(@"didReceiveMessageNotification åå­— ï¼ %@  ID ï¼ %@",userInfo.name,userInfo.userId);
    }];
    [self refreshConversationTableViewIfNeeded];
}
- (void)didReceiveMemoryWarning {
    NSLog(@"ChatViewController ReceiveMemoryWarning");

    [super didReceiveMemoryWarning];
}
@end
     èäº‘å°è£…äº†è¿™ä¸ªèŠå¤©åˆ—è¡¨çš„tableï¼Œä½†æ˜¯ä¹Ÿæä¾›ï¼ˆæˆ–è€…è¯´æš´éœ²ï¼‰äº†æ¥å£APIç»™æˆ‘ä»¬ä½¿ç”¨ï¼Œå½“ç„¶ç»†å¿ƒçš„è¯»è€…å¯ä»¥å‘ç°ï¼Œæˆ‘ç”¨äº†è‡ªå®šä¹‰çš„cellï¼Œ#import "RCCustomCell.h"
è¿™ä¸ªRCCustomCellæ˜¯è‡ªå®šä¹‰çš„cellï¼Œç»§æ‰¿RCConversationBaseCellï¼ŒRCConversationBaseCellæ˜¯ä¼šè¯cellçš„åŸºç±» ï¼Œçœ‹æºä»£ç 
/**
 *  ä¼šè¯CellåŸºç±»
 */
@interface RCConversationBaseCell : UITableViewCell

/**
 *  ä¼šè¯æ•°æ®æ¨¡å‹
 */
@property(nonatomic, strong) RCConversationModel *model;

/**
 *  è®¾ç½®ä¼šè¯æ•°æ®æ¨¡å‹
 *
 *  @param model ä¼šè¯æ•°æ®æ¨¡å‹
 */
- (void)setDataModel:(RCConversationModel *)model;
@end
```
æˆ‘ä»¬å¯ä»¥ç”¨èäº‘æš´éœ²å‡ºæ¥çš„`API`ï¼Œå®Œæˆä¸€äº›è‡ªå·±æƒ³è¦åŠ çš„åŠŸèƒ½å’Œé€»è¾‘ï¼Œä¸‹é¢ç½—åˆ—ä¸€ä¸‹ä¸€äº›åŸºæœ¬çš„`api`å’Œå±æ€§
è¿™ä¸ªæ˜¯`dataSource`æ•°ç»„ï¼Œé‡Œé¢è£…çš„å…¨æ˜¯æˆ‘ä»¬èŠå¤©çš„`model`
`@property(nonatomic, strong) NSMutableArray *conversationListDataSource;`
è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„`table`äº†ï¼Œæƒ³æ”¹å˜`frame`å’Œ`é¢œè‰²`ç­‰ï¼Œéƒ½å¯ä»¥å¯¹ä»–ä¸‹æ‰‹
`@property(nonatomic, strong) UITableView *conversationListTableView;`
ç½‘ç»œä¸å¥½çš„æ—¶å€™ï¼Œè¿™ä¸ªå¸¦ä¸€ä¸ªçº¢è‰²æç¤ºçš„ä¸œä¸œè€æ˜¯å‡ºç°ï¼Œæˆ‘ç›´æ¥ç»™ä»–è®¾ç½®`frame`ä¸º`CGRectZero`ï¼Œå¦‚æœä½ è§‰å¾—å¥½ï¼Œå¯ä»¥å¿½ç•¥è¿™ä¸ª`view``
`@property(nonatomic, strong) RCNetworkIndicatorView *networkIndicatorView;`
è¿™ä¸ªå±æ€§æ˜¯å‘Šè¯‰tableï¼Œè®©ä»–æ˜¾ç¤ºä»€ä¹ˆèŠå¤©çš„ç±»å‹ï¼Œå½“ç„¶æˆ‘çš„æ˜¯å•èŠ å°±è¿™æ ·è®¾ç½®å–½` [self setDisplayConversationTypes:@[@(ConversationType_PRIVATE)]];`
`@property(nonatomic, strong) NSArray *displayConversationTypeArray;`

ä¸‹é¢è¿™ä¸ªæ˜¯ä¼šè¯ä¸ºç©ºçš„è¯•å›¾ï¼Œé‚£ä¹ˆå¦‚æœä½ æƒ³è‡ªå®šä¹‰ï¼Œå°±è¦å¤„ç†è¿™ä¸ªé€»è¾‘äº†ï¼Œè¿˜æœ‰æ–¹æ³•é…å¥—ä½¿ç”¨çš„ï¼Œæ–¹æ³•åå­—å°±æ˜¯
`- (void)showEmptyConversationView;`
```Object-C
/**
 *  ä¼šè¯åˆ—è¡¨ä¸ºç©ºæ—¶çš„è§†å›¾
 */
@property(nonatomic, strong) UIView *emptyConversationView;


ç±»ä¼¼å°±æ˜¯ç‚¹å‡»cellçš„äº‹ä»¶
/**
 *  è¡¨æ ¼é€‰ä¸­äº‹ä»¶
 *
 *  @param conversationModelType æ•°æ®æ¨¡å‹ç±»å‹
 *  @param model                 æ•°æ®æ¨¡å‹
 *  @param indexPath             ç´¢å¼•
 */
- (void)onSelectedTableRow:(RCConversationModelType)conversationModelType
         conversationModel:(RCConversationModel *)model
               atIndexPath:(NSIndexPath *)indexPath;

è‡ªå®šä¹‰cellçš„è¯ï¼Œè‚¯å®šæ˜¯è¦å®ç°è¿”å›è‡ªå®šä¹‰cellçš„æ–¹æ³•
#pragma mark override
/**
 *  é‡å†™æ–¹æ³•ï¼Œå¯ä»¥å®ç°å¼€å‘è€…è‡ªå·±æ·»åŠ æ•°æ®modelåï¼Œè¿”å›å¯¹åº”çš„æ˜¾ç¤ºçš„cell
 *
 *  @param tableView è¡¨æ ¼
 *  @param indexPath ç´¢å¼•
 *
 *  @return RCConversationBaseTableCell
 */
- (RCConversationBaseCell *)rcConversationListTableView:(UITableView *)tableView
                                  cellForRowAtIndexPath:(NSIndexPath *)indexPath;
æ”¹å˜cellçš„é«˜åº¦ï¼Œç®€å•ï¼Œä¸è§£é‡Š
/**
 *  é‡å†™æ–¹æ³•ï¼Œå¯ä»¥å®ç°å¼€å‘è€…è‡ªå·±æ·»åŠ æ•°æ®modelåï¼Œè¿”å›å¯¹åº”çš„æ˜¾ç¤ºçš„cellçš„é«˜åº¦
 *
 *  @param tableView è¡¨æ ¼
 *  @param indexPath ç´¢å¼•
 *
 *  @return é«˜åº¦
 */
- (CGFloat)rcConversationListTableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;
- 

ç‚¹å‡»åˆ é™¤çš„äº‹ä»¶ï¼Œå¯ä»¥å¤„ç†ä¸€äº›é«˜çº§é€»è¾‘ï¼Œåˆ é™¤è¡Œï¼Œè¿˜è¦åŒæ—¶åˆ é™¤modelï¼Œç­‰ç­‰
#pragma mark override
/**
 *  é‡å†™æ–¹æ³•ï¼Œç‚¹å‡»tableViewåˆ é™¤æŒ‰é’®è§¦å‘äº‹ä»¶
 *
 *  @param tableView    è¡¨æ ¼
 *  @param editingStyle ç¼–è¾‘æ ·å¼
 *  @param indexPath    ç´¢å¼•
 */
- (void)rcConversationListTableView:(UITableView *)tableView
                 commitEditingStyle:(UITableViewCellEditingStyle)editingStyle
                  forRowAtIndexPath:(NSIndexPath *)indexPath;
```
å¦‚æœä½ è¦ç”¨èäº‘ç³»ç»Ÿçš„cellï¼Œé‚£ä¹ˆè¿™é‡Œçš„APIå¯ä»¥ä¸å†™ï¼Œç´§ç´§è®¾ç½®ä¸€å®šå±æ€§å°±å¯ä»¥äº†ï¼Œæ¯”å¦‚å¤´åƒæ˜¯åœ†çš„è¿˜æ˜¯æ–¹çš„ 
`[self setConversationAvatarStyle:RC_USER_AVATAR_CYCLE]; `
æ¯”å¦‚ï¼Œæ˜¾ç¤ºå•èŠçš„è¿˜æ˜¯ç¾¤èŠçš„`cell`ï¼Œ     
`[self setDisplayConversationTypes:@[@(ConversationType_PRIVATE)]];`
ç­‰ç­‰ï¼Œå…¶ä»–çš„å¯ä»¥ä¸å†™ã€‚å½“æœ‰éœ€è¦çš„æ—¶å€™æ‰å»çœ‹è¿™äº›`API`ï¼Œå¹¶`override`ï¼Œé‡å†™ï¼Œé‡å†™ä¹‹åå¤„ç†ä½ è‡ªå·±çš„é€»è¾‘ã€‚


 å¥½äº†ï¼Œä¸Šé¢å·²ç»æŠŠèŠå¤©åˆ—è¡¨å’ŒèŠå¤©ç•Œé¢éƒ½è®²å®Œäº†ã€‚æ›´æ–°å¤´åƒéƒ½é€»è¾‘å’Œæ–¹æ¡ˆä»¥åŠä½ ä»¬æœ€å–œæ¬¢çš„ä»£ç éƒ½è´´ä¸Šäº†ã€‚
 èŠå¤©çš„ä¸œè¥¿åˆ°æ­¤ä¸ºæ­¢ã€‚ä¸‹é¢ä¼šå¸¦æ¥è‡ªå®šä¹‰`cell`çš„æ–¹æ³•å’Œä»£ç å‚è€ƒã€‚æŒç»­å…³æ³¨ï¼ŒæŒç»­æ›´æ–°ï¼Œè°¢è°¢ï¼



>ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼åä¸½ä¸½çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼

 ##è¯´è¯´èäº‘å³æ—¶é€šè®¯SDKå¼€å‘ç¯‡ä¹‹è‡ªå®šä¹‰cell(å››)
 
 
   æ­¤ç« èŠ‚ä¸“é—¨è®²è¿°å¦‚ä½•è‡ªå®šä¹‰èŠå¤©åˆ—è¡¨ä¸­çš„`cell`ï¼Œ`cell`ï¼Œéƒ½å¯ä»¥è‡ªå®šä¹‰ï¼Œé«˜çš„ï¼ŒçŸ®çš„ï¼Œ`cell`é‡Œé¢åŠ äº†æ˜¯ç”·æ˜¯å¥³çš„æ ‡å¿—ï¼ŒåŠ äº†è¯´è¯äººçš„ç”µè¯ï¼ŒåŠ äº†è¯´è¯äººçš„å…¬å¸ï¼Œç­‰ç­‰ç­‰ç­‰éƒ½å¯ä»¥è§£å†³ã€‚è¿˜æœ‰å¦‚ä½•æ“ä½œè¿™ä¸ª`cell`ï¼Œè¿™é‡Œçš„æ“ä½œæ„æ€æ¯”è¾ƒå¹¿æ³›äº†ï¼Œæ¯”å¦‚ç»™`cell`ä¸­çš„æ§ä»¶èµ‹å€¼ï¼Œå³æ»‘åŠ¨åˆ é™¤`cell`åˆ é™¤äº†è¿˜è¦å¤„ç†é€»è¾‘ï¼Œç»™`cell`åŠ ä¸Šç±»ä¼¼`QQå¥½å‹`åˆ—è¡¨ä¸­çš„`Badge`ï¼Œè§’æ ‡ã€‚
   åºŸè¯å°‘è¯´ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œä»£ç æ‰æœ€è§£æ¸´ï¼Œç»§ç»­å¤§å°ºåº¦è´´ä»£ç ï¼ˆæˆ‘å¦‚æœç´§ç´§è®²è§£ç†è®ºè®©ä½ ä»¬å»è‡ªå·±å†™ï¼Œé‚£ä¹ˆå’Œå®˜æ–¹æ–‡æ¡£æ²¡åŒºåˆ«äº†ï¼Œä¹Ÿæ²¡äº†ä»·å€¼ï¼‰ã€‚
    è¯´ä¸€ä¸‹å¤§å‰æï¼Œç”¨ä»£ç è¡¨ç¤ºå°±æ˜¯
    `
    ifï¼ˆä½ çš„èäº‘çš„SDKå·²ç»é›†æˆåŠŸèƒ½äº†ï¼Œå¯ä»¥èŠå¤©äº§ç”Ÿcelläº†ï¼‰ï½›
     continueï¼Œç»§ç»­é˜…è¯»è‡ªå®šä¹‰cell
     ï½elseï½›
      returnï¼›
    ï½
    `
    
   é¦–å…ˆæˆ‘ä»¬è¦æ–°å»ºä¸€ä¸ª`cell`ç±»ï¼Œåå­—å«åš`RCCustomCell`ï¼Œç„¶åç»§æ‰¿èäº‘çš„`RCConversationBaseCell`ï¼Œè¿™ä¸ªæ˜¯èäº‘çš„ä¼šè¯`cell`çš„åŸºç±»ã€‚
   æˆ‘ä»¬æ¥çœ‹çœ‹åŸºç±»çš„æºä»£ç ï¼Œå¦‚ä¸‹:
   ```Object-C
   /**
 *  ä¼šè¯CellåŸºç±»
 */
@interface RCConversationBaseCell : UITableViewCell

/**
 *  ä¼šè¯æ•°æ®æ¨¡å‹
 */
@property(nonatomic, strong) RCConversationModel *model;

/**
 *  è®¾ç½®ä¼šè¯æ•°æ®æ¨¡å‹
 *
 *  @param model ä¼šè¯æ•°æ®æ¨¡å‹
 */
- (void)setDataModel:(RCConversationModel *)model;
@end
```
 å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ª`cell`é‡Œé¢å¯¹åº”ä¸€ä¸ª`model`ï¼Œè¿™ä¸ª`model`å°±æ˜¯ä¼šè¯çš„`model`ï¼Œè¿™ä¸ª`model`ä¿å­˜äº†å¾ˆå¤šçš„æœ‰å…³ä¼šè¯çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹æˆ‘ä»¬è‡ªå®šä¹‰`cell`æç¤ºä½œç”¨ã€‚è¿™ä¸ª`model`éƒ½ä¿å­˜äº†ä»€ä¹ˆä¿¡æ¯ï¼Œç»§ç»­æ­å¼€ä»–çš„é¢çº±ï¼Œå“å‘€ï¼Œå…¶å®å°±æ˜¯ç‚¹è¿›å»çœ‹æºç ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œ`model`ä¿å­˜äº†ä¼šè¯çš„ç±»å‹`RCConversationType`ï¼Œè¿˜æœ‰ç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ®`id extend`ï¼Œè¿˜æœ‰ä¼šè¯çš„`id`ï¼Œå°±æ˜¯`targetId`ï¼Œç›®æ ‡`id`å°±æ˜¯å¯¹æ–¹çš„`userId`ï¼Œè¿˜æœ‰ä¼šè¯ä¸­æœªè¯»æ¶ˆæ¯æ•°unreadMessageCountï¼Œè¿™ä¸ª`unreadMessageCount`å¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬ä¸‹é¢ä¼šç”¨åˆ°ï¼Œæ˜¯æ¯ä¸ª`cell`ä¸­å¯¹åº”çš„modelçš„æœªè¯»æ¶ˆæ¯æ•°ï¼Œä¸æ˜¯æ€»çš„æœªè¯»æ¶ˆæ¯æ•°å“¦ã€‚è¿˜æœ‰`senderUserId`å‘é€æ¶ˆæ¯`ç”¨æˆ·id`ï¼Œ`senderUserName`ï¼Œå‘é€æ¶ˆæ¯çš„ç”¨æˆ·åå­—ï¼Œå¦å¤–è¿˜æœ‰æ¥æ”¶æ—¶é—´`long long receivedTime`å’Œå‘é€çš„æ—¶é—´`long long sentTim`eç­‰ç­‰ã€‚
    è¿™ä¸ªæ˜¯ä¸æ˜¯å’Œæˆ‘ä»¬ä»ç½‘ç»œè·å–çš„`json`æ•°æ®ä¸€æ ·ï¼Œç„¶åç”¨æˆ‘ä»¬è‡ªå·±å»ºçš„`model`ä¿å­˜èµ·æ¥ï¼Œç„¶åæ”¾æ•°æ®æºæ•°ç»„é‡Œé¢è¿›è¡Œå¯¹`table`é‡Œé¢çš„æ¯ä¸ª`cell`çš„æ§ä»¶èµ‹å€¼ï¼Œå¾ˆåƒï¼Œå…¶å®å°±æ˜¯å•¦ï¼Œåªä¸è¿‡`model`å’Œ`æ•°æ®æºæ•°ç»„`æˆ‘ä»¬ä¸ç”¨ç®¡ç†äº†ï¼Œèäº‘å·²ç»å°è£…å¥½äº†ã€‚å²‚ä¸æ˜¯æ›´æ–¹ä¾¿ã€‚

   é‚£ä¹ˆæœ‰äººè¯´æˆ‘çš„`cell`ä¸Šé¢è¿˜æƒ³æ”¾ç½®å…¶ä»–çš„ä¸œè¥¿ï¼Œæ¯”å¦‚æ¯ä¸ªåŒ»ç”Ÿçš„åœ°å€å’Œç”µè¯ï¼Œè¿˜æœ‰çš„å¼€å‘è€…éœ€è¦æ”¾ç½®æ¯ä¸ªç”¨æˆ·çš„é²œèŠ±ä¸ªæ•°ï¼Œç²‰ä¸æ•°é‡ç­‰ç­‰ï¼Œé‚£ä¹ˆéƒ½æ˜¯å¯ä»¥çš„ï¼Œæ€ä¹ˆå®ç°å‘¢ï¼Œè¿™äº›éƒ½æ²¡åœ¨`model`é‡Œé¢ã€‚æˆ‘ä»¬è¿™æ ·æƒ³ï¼Œä½ èƒ½æ‹¿åˆ°`model`ï¼Œå°±å¯ä»¥æ‹¿åˆ°å¯¹æ–¹çš„`userId`ï¼Œè¿™ä¸ªæ²¡é—®é¢˜ï¼Œé‚£ä¹ˆå¯¹æ–¹çš„`id`ä½ éƒ½çŸ¥é“äº†ï¼Œä½ è¿˜æ‹¿ä¸åˆ°ä»–çš„æ‰€æœ‰ä¿¡æ¯å—ï¼Ÿè‚¯å®šæ‹¿å¾—åˆ°å¾—å‘€ï¼Œä»–ä¸æ˜¯åœ¨ä¸€ä¸ªå¥½å‹å¾—æ•°ç»„é‡Œé¢å—ï¼Ÿå»æ•°ç»„é‡Œé¢æ‰¾å•Šï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—`RCDataManger`æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œå†æ‹¿è¿‡æ¥çœ‹çœ‹
  ` -(BOOL)hasTheFriendWithUserId:(NSString *)userId;`
  ` -(RCUserInfo *)currentUserInfoWithUserId:(NSString *)userId;`
æˆ‘ä»¬å¯ä»¥é€šè¿‡`userId`åˆ¤æ–­æœ‰æ²¡æœ‰è¿™ä¸ªå¥½å‹ï¼Œå¹¶ä¸”å¯ä»¥æ‹¿åˆ°è¿™ä¸ªäººå¾—RCUserInfoï¼Œå°±æ˜¯ä»–å¾—æ‰€æœ‰ä¿¡æ¯äº†ã€‚è¿™ä¸ªRCUserInfoåœ¨åˆå§‹åŒ–å¾—æ—¶å€™è¦æä¾›ä¸€ä¸ªç‰¹æ®Šå¾—åˆå§‹åŒ–æ–¹æ³•ï¼ŒæŠŠæ¯ä¸ªå¥½å‹å¾—æ‰€æœ‰ä¿¡æ¯å­—æ®µéƒ½ä¼ è¿›å»ï¼Œè¿™ä¸ªæ–¹æ³•å‰é¢æœ‰è®²åˆ°ã€‚ä¸ä¼šå¾—åŒå­¦è¦å¤ä¹ ä¸€ä¸‹å‰é¢å¾—ä¸œè¥¿äº†ã€‚


å¥½äº†ï¼Œè¯´è¿™ä¹ˆå¤šäº†ï¼Œç»ˆäºæŠŠ`cell`çš„ç†è®ºè®²è§£å®Œäº†ï¼Œç»ˆäºå¯ä»¥ä»»æ€§çš„è´´ä»£ç äº†
å…ˆçœ‹`.h`æ–‡ä»¶é‡Œé¢ã€‚
```Object-C
#import <RongIMKit/RongIMKit.h>
#import "PPDragDropBadgeView.h"
//cellçš„é«˜åº¦ï¼Œè¿™é‡Œæ˜¯80å„é«˜åº¦
#define kCellHeight 80

@interface RCCustomCell : RCConversationBaseCell
///å¤´åƒ
@property (nonatomic,retain) UIImageView *avatarIV;
///çœŸå®å§“å
@property (nonatomic,retain) UILabel *realNameLabel;
///å¤´è¡”
@property (nonatomic,retain) UILabel *typeNameLabel;
///æ—¶é—´
@property (nonatomic,retain) UILabel *timeLabel;
///å†…å®¹
@property (nonatomic,retain) UILabel *contentLabel;
///åˆ†å‰²çº¿
@property (nonatomic,retain) UILabel *seprateLine;
///è§’æ ‡ï¼ˆUIViewï¼‰è¿™é‡Œæˆ‘ç”¨äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹ï¼Œå¾ˆå¥½ç”¨ï¼Œæä¾›Githubåœ°å€https://github.com/smallmuou/PPDragDropBadgeView
@property (nonatomic,retain) PPDragDropBadgeView *ppBadgeView;

@end
```
>å†çœ‹`.m`æ–‡ä»¶é‡Œé¢çš„ä»£ç 

```Object-C
#import "RCCustomCell.h"

#define kbadageWidth 20
#define kgap 10

/*
 
 avatarIV
 
 realNameLabel
 typeNameLabel
 timeLabel
 contentLabel
 
 */
@implementation RCCustomCell

-(instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        
        

        
        //å¤´åƒ
        self.avatarIV = [[UIImageView alloc]initWithFrame:CGRectMake(kgap, kgap, kCellHeight-2*kgap, kCellHeight-2*kgap)];
        self.avatarIV.clipsToBounds = YES;
        self.avatarIV.layer.cornerRadius = 8;
//        self.avatarIV.image = [UIImage imageNamed:@"default_portrait_msg"];
        [self.contentView addSubview:self.avatarIV];
        //realName
        self.realNameLabel = [[UILabel alloc]initWithFrame:CGRectMake(self.avatarIV.frame.origin.x+self.avatarIV.frame.size.width+kgap, self.avatarIV.frame.origin.y+7, self.avatarIV.frame.size.width+40, self.avatarIV.frame.size.height/2-kgap/2)];
        self.realNameLabel.font = [UIFont systemFontOfSize:18];
        self.realNameLabel.textColor = kFontColor_333333;
//        self.realNameLabel.backgroundColor = [UIColor cyanColor];
        [self.contentView addSubview:self.realNameLabel];
        //å¤´è¡”
        self.typeNameLabel = [[UILabel alloc]initWithFrame:CGRectMake(self.realNameLabel.frame.origin.x+self.realNameLabel.frame.size.width+kgap, self.realNameLabel.frame.origin.y, self.realNameLabel.frame.size.width*2, self.realNameLabel.frame.size.height)];
        self.typeNameLabel.font = [UIFont systemFontOfSize:15];
        self.typeNameLabel.textColor = kColor_TintRed;
//        self.typeNameLabel.backgroundColor = [UIColor magentaColor];
        [self.contentView addSubview:self.typeNameLabel];
        //æ—¶é—´
        self.timeLabel = [[UILabel alloc]initWithFrame:CGRectMake(kScreenWidth-90-5, self.typeNameLabel.frame.origin.y, 90, self.typeNameLabel.frame.size.height)];
        self.timeLabel.textAlignment = NSTextAlignmentRight;
        self.timeLabel.font = [UIFont systemFontOfSize:15];
        self.timeLabel.textColor = kFontColor_999999;
        [self.contentView addSubview:self.timeLabel];
        //å†…å®¹
        self.contentLabel = [[UILabel alloc]initWithFrame:CGRectMake(self.realNameLabel.frame.origin.x, self.realNameLabel.frame.origin.y+self.realNameLabel.frame.size.height+2, kScreenWidth-self.avatarIV.frame.size.width-2*kgap-5-30, self.typeNameLabel.frame.size.height)];
//        self.contentLabel.backgroundColor = [UIColor purpleColor];
        self.contentLabel.textColor = kFontColor_999999;
        self.contentLabel.font = [UIFont systemFontOfSize:15];
        [self.contentView addSubview:self.contentLabel];
        //è§’æ ‡ï¼Œè¿™ä¸ªç”¨æ¥æ˜¾ç¤ºæ¯ä¸ªå¥½å‹çš„è§’æ ‡ï¼Œå®ç°ç±»ä¼¼QQèŠå¤©åˆ—è¡¨ä¸­å¼ºå¤§çš„æ‹–æ›³è§’æ ‡çš„åŠŸèƒ½
        self.ppBadgeView = [[PPDragDropBadgeView alloc]initWithFrame:CGRectMake(self.contentLabel.frame.origin.x+self.contentLabel.frame.size.width, self.contentLabel.frame.origin.y, 25, 25)];
        self.ppBadgeView.fontSize = 12;
        [self.contentView addSubview:self.ppBadgeView];
        ///åˆ†å‰²çº¿
        self.seprateLine =[[UILabel alloc]initWithFrame:CGRectMake(self.realNameLabel.frame.origin.x, kCellHeight-2, kScreenWidth-self.avatarIV.frame.size.width-2*kgap, 0.5)];
        //        self.contentLabel.backgroundColor = [UIColor purpleColor];
        self.seprateLine.backgroundColor = [UIColor lightGrayColor];
        [self.contentView addSubview:self.seprateLine];
    }
    return self;
}
-(void)layoutSubviews{
    [super layoutSubviews];
    
}
@end
```
åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±æŠŠ`cell`è‡ªå®šä¹‰ä»£ç å†™å®Œäº†ï¼Œé‚£ä¹ˆä¸‹é¢å°±æ˜¯ä½¿ç”¨è¿™ä¸ª`cell`äº†ã€‚æ€ä¹ˆç”¨ï¼Œæ€ä¹ˆæ›¿æ¢ç³»ç»Ÿçš„`cell`ã€‚ç»§ç»­å¾€ä¸‹çœ‹ï¼Œåˆ°èŠå¤©åˆ—è¡¨`vc`ä¸­æ”¹ä»£ç ã€‚

```Object-C
-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
  return  self.conversationListDataSource.count;
}
//é«˜åº¦
-(CGFloat)rcConversationListTableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{
    return kCellHeight;
}
#pragma mark
#pragma mark æ˜¯å¦ç¦æ­¢å³æ»‘åˆ é™¤
-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath{
    return YES;
}
//å·¦æ»‘åˆ é™¤
-(void)rcConversationListTableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath{
    //å¯ä»¥ä»æ•°æ®åº“åˆ é™¤æ•°æ®
    if (indexPath.row < self.conversationListDataSource.count) {
    RCConversationModel *model = self.conversationListDataSource[indexPath.row];
    [[RCIMClient sharedRCIMClient] removeConversation:ConversationType_PRIVATE targetId:model.targetId];
    [self.conversationListDataSource removeObjectAtIndex:indexPath.row];
    [self.conversationListTableView reloadData];
    [[RCDataManager shareManager] refreshBadgeValue];
    }
}

 //*********************ä¿®æ”¹è‡ªå®šä¹‰Cellä¸­modelçš„ä¼šè¯modelç±»å‹*********************//

//æ’å…¥è‡ªå®šä¹‰ä¼šè¯model,è¿™ä¸ªå¾ˆé‡è¦ï¼Œä¸€å®šè¦å®ç°
-(NSMutableArray *)willReloadTableData:(NSMutableArray *)dataSource{
    for (int i=0; i<dataSource.count; i++) {
        RCConversationModel *model = dataSource[i];
        if(model.conversationType == ConversationType_PRIVATE){//å¦‚æœæ˜¯å•ä¾‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ”¹modelçš„ä¸€ä¸ªå±æ€§ï¼Œå°±æ˜¯æŠŠä¼šè¯modelçš„ç±»å‹æ”¹ä¸ºè‡ªå®šä¹‰
            model.conversationModelType = RC_CONVERSATION_MODEL_TYPE_CUSTOMIZATION;
        }
    }
    return dataSource;
}
```
 > å¼€å§‹ä½¿ç”¨è‡ªå®šä¹‰cell
 
 //*********************æ’å…¥è‡ªå®šä¹‰Cell*********************//
è¿™ä¸ªè¿”å›cellçš„æ–¹æ³•ï¼Œä»¥å‰ä¹Ÿè´´å‡ºæ¥è¿‡ï¼Œä¸è¿‡æ³¨è§†æ¯”è¾ƒå°‘ï¼Œè¿™æ¬¡ä¸“é—¨æ¥è®²è§£è¿™ä¸ªè¿”å›cellçš„æ–¹æ³•ï¼Œè¿™é‡Œå°±è¿”å›äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„cell
```Object-C
-(RCConversationBaseCell *)rcConversationListTableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    if (self.conversationListDataSource.count&&indexPath.row < self.conversationListDataSource.count) {
    //é¦–å…ˆæˆ‘ä»¬è¦ä»æ•°æ®æºæ•°ç»„ä¸­å–å‡ºèäº‘çš„modelç±»ï¼Œæ–¹ä¾¿ä¸‹é¢ä½¿ç”¨modelçš„å±æ€§ï¼Œå¤§æŠŠèµ„æ–™è¦ä»modelçš„å±æ€§ä¸­è·å–ï¼Œæˆ–è€…é—´æ¥è·å–åˆ°
        RCConversationModel *model = self.conversationListDataSource[indexPath.row];
        [[RCDataManager shareManager] getUserInfoWithUserId:model.targetId completion:^(RCUserInfo *userInfo) {
            NSLog(@"rcConversationListTableView åå­— ï¼ %@  ID ï¼ %@",userInfo.name,userInfo.userId);
        }];
        NSInteger unreadCount = model.unreadMessageCount;//æ¯ä¸ªcellçš„æœªè¯»æ¶ˆæ¯æ•°é‡
        RCCustomCell *cell = (RCCustomCell *)[[RCCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"RCCustomCell"];
       æˆ‘ä»¬alloc ä¸€ä¸ªè‡ªå·±çš„cellï¼Œä¸‹é¢ç»™ä»–èµ‹å€¼ï¼Œå¤„ç†é€»è¾‘
        
        NSDate *date = [NSDate dateWithTimeIntervalSince1970:model.receivedTime/1000];
        NSString *timeString = [[MSUtil stringFromDate:date] substringToIndex:10];
        NSString *temp = [MSUtil getyyyymmdd];
        NSString *nowDateString = [NSString stringWithFormat:@"%@-%@-%@",[temp substringToIndex:4],[temp substringWithRange:NSMakeRange(4, 2)],[temp substringWithRange:NSMakeRange(6, 2)]];
        
        if ([timeString isEqualToString:nowDateString]) {
            NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
            [formatter setDateFormat:@"HH:mm"];
            NSString *showtimeNew = [formatter stringFromDate:date];
            //è¿™é‡Œèµ‹å€¼æ—¶é—´ï¼Œæ—¶é—´æ˜¾ç¤ºï¼Œèäº‘modeé‡Œé¢çš„æ˜¯long longç±»å‹çš„ï¼Œç”¨çš„æ—¶å€™ä¸€å®šè¦è½¬åŒ–ï¼Œæ–¹æ³•å’Œä»£ç éƒ½æœ‰äº†ï¼Œä¸å¤šèµ˜è¿°
            cell.timeLabel.text = [NSString stringWithFormat:@"%@",showtimeNew];

        }else{
            cell.timeLabel.text = [NSString stringWithFormat:@"%@",timeString];
        }
        //å¤„ç†è§’æ ‡çš„æ‹–æ›³ï¼Œè¿™é‡Œæ‹–æ›³å®Œæˆä¹‹åå›è°ƒä¸€ä¸ªblockï¼Œåœ¨blocké‡Œé¢æˆ‘ä»¬è¦å¤„ç†é€»è¾‘äº†ï¼Œä½ æŠŠè§’æ ‡æ‹–æ›³æ‰ä¹‹åï¼Œè¦è°ƒç”¨RCIMClientè¿™ä¸ªå•ä¾‹ï¼Œè®¾ç½®æŸäººçš„æœªè¯»æ¶ˆæ¯ä¸º0.å› ä¸ºä½ å·²ç»æ‹–æ›³æ‰äº†è¿™ä¸ªè§’æ ‡å•Šã€‚åˆ°æ­¤è¿˜ä¸è¡Œï¼Œå› ä¸ºæ•°æ®æºé‡Œé¢modelçš„å±æ€§æ²¡å˜ï¼Œmodelçš„å±æ€§æ²¡å˜ï¼Œæ»‘åŠ¨tableï¼Œè§’æ ‡åˆä¸€æ¬¡å‡ºç°äº†ï¼Œæ²»æ ‡ä¸æ²»æœ¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è®¾ç½®model.unreadMessageCount = 0;é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·å°±åšåˆ°äº†ï¼Œèäº‘æœåŠ¡å™¨ä¸Šçš„æŸäººçš„æœªè¯»æ¶ˆæ¯æ•°é‡å’Œæœ¬åœ°cellä¸Šé¢çš„ä¸€è‡´äº†ï¼›
        cell.ppBadgeView.dragdropCompletion = ^{
                    NSLog(@"VC = FFF ï¼ŒID ï¼ %@",model.targetId);
            
            
            
           
            
            [[RCIMClient sharedRCIMClient] clearMessagesUnreadStatus:ConversationType_PRIVATE targetId:model.targetId];
            model.unreadMessageCount = 0;
            NSInteger ToatalunreadMsgCount = (NSInteger)[[RCIMClient sharedRCIMClient] getUnreadCount:@[@(ConversationType_PRIVATE)]];
            
            long tabBarCount = ToatalunreadMsgCount-model.unreadMessageCount;
            int notReadMessage = [[UserInfoModel currentUserinfo].notReadMessage intValue];
            
            if (tabBarCount > 0) {
                [AppDelegate shareAppDelegate].rootTabbar.selectedViewController.tabBarItem.badgeValue = [NSString stringWithFormat:@"%ld",tabBarCount];
                
                if (notReadMessage > 0) {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = notReadMessage + tabBarCount;
                }
                else {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = tabBarCount;
                }
            }
            else {
                [AppDelegate shareAppDelegate].rootTabbar.selectedViewController.tabBarItem.badgeValue = nil;
                
                if (notReadMessage > 0) {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = notReadMessage;
                }
                else {
                    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;
                }
            }
        };
        if (unreadCount==0) {
            cell.ppBadgeView.text = @"";
        
        }else{
            if (unreadCount>=100) {
                cell.ppBadgeView.text = @"99+";
            }else{
                cell.ppBadgeView.text = [NSString stringWithFormat:@"%li",(long)unreadCount];

            }
        }

        

        for (RCUserInfo *userInfo in [AppDelegate shareAppDelegate].friendsArray) {
            if ([model.targetId isEqualToString:userInfo.userId]) {
                //èµ‹å€¼åå­—å±æ€§
                cell.realNameLabel.text = [userInfo.realName isEqualToString:@""]?[NSString stringWithFormat:@"%@",userInfo.name]:[NSString stringWithFormat:@"%@",userInfo.realName];
                
                
                UsersType type = [MSUtil checkUserType];
                
              
                
                
                if (type==UsersTypeYouke) {
                    
                }else if (type==UsersTypeCustomer){
                    cell.typeNameLabel.text = @"å¤´è¡”";
                    
                }else if (type==UsersTypeSales){
                    cell.typeNameLabel.text = @"å®¢æˆ·";
                    cell.typeNameLabel.textColor = kFontColor_999999;
                }
    //èµ‹å€¼å¤´åƒ
                if ([userInfo.portraitUri isEqualToString:@""]||userInfo.portraitUri==nil) {
                    cell.avatarIV.image = [UIImage imageNamed:@"chatlistDefault"];
                    [cell.contentView bringSubviewToFront:cell.avatarIV];
                }else{
                    [cell.avatarIV sd_setImageWithURL:[NSURL URLWithString:userInfo.portraitUri] placeholderImage:[UIImage imageNamed:@"chatlistDefault"]];
                }
                
                if ([model.lastestMessage isKindOfClass:[RCTextMessage class]]) {
                    cell.contentLabel.text = [model.lastestMessage valueForKey:@"content"];
                    
                }else if ([model.lastestMessage isKindOfClass:[RCImageMessage class]]){
                    
                    if ([model.senderUserId isEqualToString:[RCIMClient sharedRCIMClient].currentUserInfo.userId]) {
                        //æˆ‘è‡ªå·±å‘çš„
                        RCUserInfo *myselfInfo = [RCIMClient sharedRCIMClient].currentUserInfo;
                        
                        if ([[NSString stringWithFormat:@"%@",myselfInfo.realName] isEqualToString:@""]) {
                            cell.contentLabel.text =[NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„å›¾ç‰‡æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.name];
                        }else{
                            cell.contentLabel.text =[NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„å›¾ç‰‡æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.realName];
                            
                        }
                    }else{
                        
                        cell.contentLabel.text =[NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„å›¾ç‰‡æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",userInfo.realName] ;
                    }
                    
                }else if ([model.lastestMessage isKindOfClass:[RCVoiceMessage class]]){
                    if ([model.senderUserId isEqualToString:[RCIMClient sharedRCIMClient].currentUserInfo.userId]) {
                        //æˆ‘è‡ªå·±å‘çš„
                        RCUserInfo *myselfInfo = [RCIMClient sharedRCIMClient].currentUserInfo;
                        if ([[NSString stringWithFormat:@"%@",myselfInfo.realName] isEqualToString:@""]) {
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„è¯­éŸ³æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.name];
                            
                        }else{
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„è¯­éŸ³æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.realName];
                        }
                    }else{
                        cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„è¯­éŸ³æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",userInfo.realName];
                    }
                }
                else if ([model.lastestMessage isKindOfClass:[RCLocationMessage class]]){
                    if ([model.senderUserId isEqualToString:[RCIMClient sharedRCIMClient].currentUserInfo.userId]) {
                        //æˆ‘è‡ªå·±å‘çš„
                        RCUserInfo *myselfInfo = [RCIMClient sharedRCIMClient].currentUserInfo;
                        if ([[NSString stringWithFormat:@"%@",myselfInfo.realName] isEqualToString:@""]) {
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„ä½ç½®æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.name];
                        }else{
                            cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„ä½ç½®æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",myselfInfo.realName];
                        }
                    }else{
                        cell.contentLabel.text = [NSString stringWithFormat:@"æ¥è‡ª\"%@\"çš„ä½ç½®æ¶ˆæ¯ï¼Œç‚¹å‡»æŸ¥çœ‹",userInfo.realName];
                    }
                }
                
            }
        }
        
        return cell;
    }
    else{
        
        return [[RCConversationBaseCell alloc]init];
    }
    
    
}
```

åˆ°æ­¤ï¼Œè‡ªå®šä¹‰`cell`åº”è¯¥æ²¡é—®é¢˜äº†ï¼Œå¦‚æœæœ‰é—®é¢˜ï¼Œç¾¤é‡Œè”ç³»æˆ‘ `479259423`

# æ¬¢è¿å…³æ³¨æˆ‘çš„æ–—é±¼ç›´æ’­é—´ï¼Œç”¨æ‰‹æœºæ–—é±¼TVï¼Œç›´æ¥æœç´¢â€œæ–‡æ˜ç›´æ’­é—´â€æˆ–è€…â€œæç«¯ææƒ§â€å°±å¯ä»¥æ‰¾åˆ°æˆ‘çš„ç›´æ’­ã€‚iOSæŠ€æœ¯åˆ†äº«ç›´æ’­ã€‚è¿›æ¥ç‚¹ä¸€ä¸‹å…³æ³¨ï¼Œè°¢è°¢ï¼Œå¼€æ’­ä¼šæœ‰æ¨é€åˆ°å¤§å®¶æ‰‹æœºã€‚ï¼ˆä¸ªäººç›´æ’­ï¼Œéæœºæ„ï¼Œé€‚åˆåˆçº§iOSå’Œä¸­çº§iOSï¼Œé«˜çº§iOSä¸ç”¨è¿›æ¥å–·æˆ‘äº†ï¼Œè°¢è°¢ï¼‰ã€‚
